module.exports=[33405,(a,b,c)=>{b.exports=a.x("child_process",()=>require("child_process"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},97599,(a,b,c)=>{"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,h=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===e.call(a)},i=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b,c=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!c&&!f)return!1;for(b in a);return void 0===b||d.call(a,b)},j=function(a,b){f&&"__proto__"===b.name?f(a,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):a[b.name]=b.newValue},k=function(a,b){if("__proto__"===b){if(!d.call(a,b))return;else if(g)return g(a,b).value}return a[b]};b.exports=function a(){var b,c,d,e,f,g,l=arguments[0],m=1,n=arguments.length,o=!1;for("boolean"==typeof l&&(o=l,l=arguments[1]||{},m=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});m<n;++m)if(b=arguments[m],null!=b)for(c in b)d=k(l,c),l!==(e=k(b,c))&&(o&&e&&(i(e)||(f=h(e)))?(f?(f=!1,g=d&&h(d)?d:[]):g=d&&i(d)?d:{},j(l,{name:c,newValue:a(o,g,e)})):void 0!==e&&j(l,{name:c,newValue:e}));return l}},451,a=>{a.v({name:"gaxios",version:"7.1.3",description:"A simple common HTTP client specifically for Google APIs and services.",main:"build/cjs/src/index.js",types:"build/cjs/src/index.d.ts",files:["build/"],exports:{".":{import:{types:"./build/esm/src/index.d.ts",default:"./build/esm/src/index.js"},require:{types:"./build/cjs/src/index.d.ts",default:"./build/cjs/src/index.js"}}},scripts:{lint:"gts check --no-inline-config",test:"c8 mocha build/esm/test","presystem-test":"npm run compile","system-test":"mocha build/esm/system-test --timeout 80000",compile:"tsc -b ./tsconfig.json ./tsconfig.cjs.json && node utils/enable-esm.mjs",fix:"gts fix",prepare:"npm run compile",pretest:"npm run compile",webpack:"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js",docs:"jsdoc -c .jsdoc.js","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../",prelint:"cd samples; npm link ../; npm install",clean:"gts clean"},repository:{type:"git",directory:"packages/gaxios",url:"https://github.com/googleapis/google-cloud-node-core.git"},keywords:["google"],engines:{node:">=18"},author:"Google, LLC",license:"Apache-2.0",devDependencies:{"@babel/plugin-proposal-private-methods":"^7.18.6","@types/cors":"^2.8.6","@types/express":"^5.0.0","@types/extend":"^3.0.1","@types/mocha":"^10.0.10","@types/multiparty":"4.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","@types/tmp":"0.2.6",assert:"^2.0.0",browserify:"^17.0.0",c8:"^10.0.0",cors:"^2.8.5",express:"^5.0.0",gts:"^6.0.0","is-docker":"^3.0.0",jsdoc:"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1",linkinator:"^6.1.2",mocha:"^11.1.0",multiparty:"^4.2.1",mv:"^2.1.1",ncp:"^2.0.0",nock:"^14.0.0-beta.13","null-loader":"^4.0.0","pack-n-play":"^4.0.0",puppeteer:"^24.0.0",sinon:"^21.0.0","stream-browserify":"^3.0.0",tmp:"0.2.5","ts-loader":"^9.5.2",typescript:"^5.8.3",webpack:"^5.35.0","webpack-cli":"^6.0.1"},dependencies:{extend:"^3.0.2","https-proxy-agent":"^7.0.1","node-fetch":"^3.3.2",rimraf:"^5.0.1"},homepage:"https://github.com/googleapis/google-cloud-node-core/tree/main/packages/gaxios"})},52947,(a,b,c)=>{"use strict";b.exports={pkg:a.r(451)}},69565,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosError=c.GAXIOS_ERROR_SYMBOL=void 0,c.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){a&&a.forEach((b,d)=>{(/^authentication$/i.test(d)||/^authorization$/i.test(d)||/secret/i.test(d))&&a.set(d,c)})}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function f(a){!a||"object"!=typeof a||(a instanceof FormData||a instanceof URLSearchParams||"forEach"in a&&"set"in a?a.forEach((b,d)=>{(["grant_type","assertion"].includes(d)||/secret/.test(d))&&a.set(d,c)}):("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c)))}return b.config&&(d(b.config.headers),e(b.config,"data"),f(b.config.data),e(b.config,"body"),f(b.config.body),b.config.url.searchParams.has("token")&&b.config.url.searchParams.set("token",c),b.config.url.searchParams.has("client_secret")&&b.config.url.searchParams.set("client_secret",c)),b.response&&(a({config:b.response.config}),d(b.response.headers),b.response.bodyUsed&&(e(b.response,"data"),f(b.response.data))),b};let e=d(a.r(97599)),f=d(a.r(52947)).default.pkg;c.GAXIOS_ERROR_SYMBOL=Symbol.for(`${f.name}-gaxios-error`);class g extends Error{config;response;code;status;error;[c.GAXIOS_ERROR_SYMBOL]=f.version;static[Symbol.hasInstance](a){return!!a&&"object"==typeof a&&c.GAXIOS_ERROR_SYMBOL in a&&a[c.GAXIOS_ERROR_SYMBOL]===f.version||Function.prototype[Symbol.hasInstance].call(g,a)}constructor(a,b,c,d){if(super(a,{cause:d}),this.config=b,this.response=c,this.error=d instanceof Error?d:void 0,this.config=(0,e.default)(!0,{},b),this.response&&(this.response.config=(0,e.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}d instanceof DOMException?this.code=d.name:d&&"object"==typeof d&&"code"in d&&("string"==typeof d.code||"number"==typeof d.code)&&(this.code=d.code)}static extractAPIErrorFromResponse(a,b="The request failed"){let c=b;if("string"==typeof a.data&&(c=a.data),a.data&&"object"==typeof a.data&&"error"in a.data&&a.data.error&&!a.ok){if("string"==typeof a.data.error)return{message:a.data.error,code:a.status,status:a.statusText};if("object"==typeof a.data.error){c="message"in a.data.error&&"string"==typeof a.data.error.message?a.data.error.message:c;let b="status"in a.data.error&&"string"==typeof a.data.error.status?a.data.error.status:a.statusText,d="code"in a.data.error&&"number"==typeof a.data.error.code?a.data.error.code:a.status;if("errors"in a.data.error&&Array.isArray(a.data.error.errors)){let e=[];for(let b of a.data.error.errors)"object"==typeof b&&"message"in b&&"string"==typeof b.message&&e.push(b.message);return Object.assign({message:e.join("\n")||c,code:d,status:b},a.data.error)}return Object.assign({message:c,code:d,status:b},a.data.error)}}return{message:c,code:a.status,status:a.statusText}}}c.GaxiosError=g},63492,(a,b,c)=>{"use strict";async function d(a){var b;let c=f(a);if(!a||!a.config||!c&&!a.config.retry)return{shouldRetry:!1};(c=c||{}).currentRetryAttempt=c.currentRetryAttempt||0,c.retry=void 0===c.retry||null===c.retry?3:c.retry,c.httpMethodsToRetry=c.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],c.noResponseRetries=void 0===c.noResponseRetries||null===c.noResponseRetries?2:c.noResponseRetries,c.retryDelayMultiplier=c.retryDelayMultiplier?c.retryDelayMultiplier:2,c.timeOfFirstRequest=c.timeOfFirstRequest?c.timeOfFirstRequest:Date.now(),c.totalTimeout=c.totalTimeout?c.totalTimeout:Number.MAX_SAFE_INTEGER,c.maxRetryDelay=c.maxRetryDelay?c.maxRetryDelay:Number.MAX_SAFE_INTEGER,c.statusCodesToRetry=c.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=c;let d=c.shouldRetry||e;if(!await d(a))return{shouldRetry:!1,config:a.config};let g=Math.min(((b=c).currentRetryAttempt?0:b.retryDelay??100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let h=c.retryBackoff?c.retryBackoff(a,g):new Promise(a=>{setTimeout(a,g)});return c.onRetryAttempt&&await c.onRetryAttempt(a),await h,{shouldRetry:!0,config:a.config}}function e(a){let b=f(a);if(a.config.signal?.aborted&&"TimeoutError"!==a.code||"AbortError"===a.code||!b||0===b.retry||!a.response&&(b.currentRetryAttempt||0)>=b.noResponseRetries||!b.httpMethodsToRetry||!b.httpMethodsToRetry.includes(a.config.method?.toUpperCase()||"GET"))return!1;if(a.response&&a.response.status){let c=!1;for(let[d,e]of b.statusCodesToRetry){let b=a.response.status;if(b>=d&&b<=e){c=!0;break}}if(!c)return!1}return b.currentRetryAttempt=b.currentRetryAttempt||0,!(b.currentRetryAttempt>=b.retry)}function f(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(c,"__esModule",{value:!0}),c.getRetryConfig=d},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},69706,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosInterceptorManager=void 0;class d extends Set{}c.GaxiosInterceptorManager=d},76176,(a,b,c)=>{"use strict";var d,e=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.Gaxios=void 0;let f=e(a.r(97599)),g=a.r(24836),h=a.r(69565),i=a.r(63492),j=a.r(88947),k=a.r(69706),l=async()=>globalThis.crypto?.randomUUID()||(await a.A(85685)).randomUUID();class m{agentCache=new Map;defaults;interceptors;constructor(a){this.defaults=a||{},this.interceptors={request:new k.GaxiosInterceptorManager,response:new k.GaxiosInterceptorManager}}fetch(...a){let b,c=a[0],e=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&d.mergeHeaders(f,c.headers),e&&d.mergeHeaders(f,new Headers(e.headers)),"object"!=typeof c||c instanceof URL)?this.request({...e,headers:f,url:b}):this.request({...e,...c,headers:f,url:b})}async request(a={}){let b=await this.#a(a);return b=await this.#b(b),this.#c(this._request(b))}async _defaultAdapter(a){let b=a.fetchImplementation||this.defaults.fetchImplementation||await d.#d(),c={...a};delete c.data;let e=await b(a.url,c),f=await this.getResponseData(a,e);return Object.getOwnPropertyDescriptor(e,"data")?.configurable||Object.defineProperties(e,{data:{configurable:!0,writable:!0,enumerable:!0,value:f}}),Object.assign(e,{config:a,data:f})}async _request(a){try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a=[];for await(let c of b.data)a.push(c);b.data=a.toString()}let c=h.GaxiosError.extractAPIErrorFromResponse(b,`Request failed with status code ${b.status}`);throw new h.GaxiosError(c?.message,a,b,c)}return b}catch(e){let b;b=e instanceof h.GaxiosError?e:e instanceof Error?new h.GaxiosError(e.message,a,void 0,e):new h.GaxiosError("Unexpected Gaxios Error",a,void 0,e);let{shouldRetry:c,config:d}=await (0,i.getRetryConfig)(b);if(c&&d)return b.config.retryConfig.currentRetryAttempt=d.retryConfig.currentRetryAttempt,a.retryConfig=b.config?.retryConfig,this.#e(a),this._request(a);throw a.errorRedactor&&a.errorRedactor(b),b}}async getResponseData(a,b){if(204===b.status)return"";if(a.maxContentLength&&b.headers.has("content-length")&&a.maxContentLength<Number.parseInt(b.headers?.get("content-length")||""))throw new h.GaxiosError("Response's `Content-Length` is over the limit.",a,Object.assign(b,{config:a}));switch(a.responseType){case"stream":return b.body;case"json":{let a=await b.text();try{return JSON.parse(a)}catch{return a}}case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}#f(a,b=[]){let c=new URL(a),d=[...b];for(let a of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])d.push(a.trim());for(let a of d)if(a instanceof RegExp){if(a.test(c.toString()))return!1}else if(a instanceof URL){if(a.origin===c.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(c.hostname.endsWith(b))return!1}else if(a===c.origin||a===c.hostname||a===c.href)return!1;return!0}async #b(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #c(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #a(a){let b=new Headers(this.defaults.headers);d.mergeHeaders(b,a.headers);let c=(0,f.default)(!0,{},this.defaults,a);if(!c.url)throw Error("URL is required.");if(c.baseURL&&(c.url=new URL(c.url,c.baseURL)),c.url=new URL(c.url),c.params)if(c.paramsSerializer){let a=c.paramsSerializer(c.params);a.startsWith("?")&&(a=a.slice(1));let b=c.url.toString().includes("?")?"&":"?";c.url=c.url+b+a}else{let a=c.url instanceof URL?c.url:new URL(c.url);for(let[b,d]of new URLSearchParams(c.params))a.searchParams.append(b,d);c.url=a}"number"==typeof a.maxContentLength&&(c.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(c.follow=a.maxRedirects);let e="string"==typeof c.data||c.data instanceof ArrayBuffer||c.data instanceof Blob||globalThis.File&&c.data instanceof File||c.data instanceof FormData||c.data instanceof j.Readable||c.data instanceof ReadableStream||c.data instanceof String||c.data instanceof URLSearchParams||ArrayBuffer.isView(c.data)||["Blob","File","FormData"].includes(c.data?.constructor?.name||"");if(c.multipart?.length){let a=await l();b.set("content-type",`multipart/related; boundary=${a}`),c.body=j.Readable.from(this.getMultipartRequest(c.multipart,a))}else e?c.body=c.data:"object"==typeof c.data?"application/x-www-form-urlencoded"===b.get("Content-Type")?c.body=c.paramsSerializer?c.paramsSerializer(c.data):new URLSearchParams(c.data):(b.has("content-type")||b.set("content-type","application/json"),c.body=JSON.stringify(c.data)):c.data&&(c.body=c.data);c.validateStatus=c.validateStatus||this.validateStatus,c.responseType=c.responseType||"unknown",b.has("accept")||"json"!==c.responseType||b.set("accept","application/json");let i=c.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(c.agent);else if(i&&this.#f(c.url,c.noProxy)){let a=await d.#g();this.agentCache.has(i)?c.agent=this.agentCache.get(i):(c.agent=new a(i,{cert:c.cert,key:c.key}),this.agentCache.set(i,c.agent))}else c.cert&&c.key&&(this.agentCache.has(c.key)?c.agent=this.agentCache.get(c.key):(c.agent=new g.Agent({cert:c.cert,key:c.key}),this.agentCache.set(c.key,c.agent)));return"function"!=typeof c.errorRedactor&&!1!==c.errorRedactor&&(c.errorRedactor=h.defaultErrorRedactor),!c.body||"duplex"in c||(c.duplex="half"),this.#e(c),Object.assign(c,{headers:b,url:c.url instanceof URL?c.url:new URL(c.url)})}#e(a){if(a.timeout){let b=AbortSignal.timeout(a.timeout);a.signal&&!a.signal.aborted?a.signal=AbortSignal.any([a.signal,b]):a.signal=b}}validateStatus(a){return a>=200&&a<300}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch{}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers.get("Content-Type")||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}static #h;static #i;static async #g(){return this.#h||=(await a.A(57882)).HttpsProxyAgent,this.#h}static async #d(){return this.#i||=(await a.A(69375)).default,this.#i}static mergeHeaders(a,...b){for(let c of(a=a instanceof Headers?a:new Headers(a),b))(c instanceof Headers?c:new Headers(c)).forEach((b,c)=>{"set-cookie"===c?a.append(c,b):a.set(c,b)});return a}}c.Gaxios=m,d=m},99853,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.instance=c.Gaxios=c.GaxiosError=void 0,c.request=h;let f=a.r(76176);Object.defineProperty(c,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=a.r(69565);async function h(a){return c.instance.request(a)}Object.defineProperty(c,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(a.r(69706),c),c.instance=new f.Gaxios},46786,(a,b,c)=>{b.exports=a.x("os",()=>require("os"))},85364,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GCE_LINUX_BIOS_PATHS=void 0,c.isGoogleCloudServerless=f,c.isGoogleComputeEngineLinux=g,c.isGoogleComputeEngineMACAddress=h,c.isGoogleComputeEngine=i,c.detectGCPResidency=function(){return f()||i()},a.r(22734);let d=a.r(46786);c.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let e=/^42:01/;function f(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function g(){if("linux"!==(0,d.platform)())return!1}function h(){for(let a of Object.values((0,d.networkInterfaces)()))if(a){for(let{mac:b}of a)if(e.test(b))return!0}return!1}function i(){return g()||h()}},30168,(a,b,c)=>{!function(c){"use strict";var d,e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,f=Math.ceil,g=Math.floor,h="[BigNumber Error] ",i=h+"Number primitive has more than 15 significant digits: ",j=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function k(a){var b=0|a;return a>0||a===b?b:b-1}function l(a){for(var b,c,d=1,e=a.length,f=a[0]+"";d<e;){for(c=14-(b=a[d++]+"").length;c--;b="0"+b);f+=b}for(e=f.length;48===f.charCodeAt(--e););return f.slice(0,e+1||1)}function m(a,b){var c,d,e=a.c,f=b.c,g=a.s,h=b.s,i=a.e,j=b.e;if(!g||!h)return null;if(c=e&&!e[0],d=f&&!f[0],c||d)return c?d?0:-h:g;if(g!=h)return g;if(c=g<0,d=i==j,!e||!f)return d?0:!e^c?1:-1;if(!d)return i>j^c?1:-1;for(g=0,h=(i=e.length)<(j=f.length)?i:j;g<h;g++)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1}function n(a,b,c,d){if(a<b||a>c||a!==g(a))throw Error(h+(d||"Argument")+("number"==typeof a?a<b||a>c?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function o(a){var b=a.c.length-1;return k(a.e/14)==b&&a.c[b]%2!=0}function p(a,b){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(b<0?"e":"e+")+b}function q(a,b,c){var d,e;if(b<0){for(e=c+".";++b;e+=c);a=e+a}else if(d=a.length,++b>d){for(e=c,b-=d;--b;e+=c);a+=e}else b<d&&(a=a.slice(0,b)+"."+a.slice(b));return a}if((d=function a(b){var c,d,r,s,t,u,v,w,x,y=M.prototype={constructor:M,toString:null,valueOf:null},z=new M(1),A=20,B=4,C=-7,D=21,E=-1e7,F=1e7,G=!1,H=1,I=0,J={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},K="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function M(a,b){var c,d,f,h,j,k,l,m,o=this;if(!(o instanceof M))return new M(a,b);if(null==b){if(a&&!0===a._isBigNumber){o.s=a.s,!a.c||a.e>F?o.c=o.e=null:a.e<E?o.c=[o.e=0]:(o.e=a.e,o.c=a.c.slice());return}if((k="number"==typeof a)&&0*a==0){if(o.s=1/a<0?(a=-a,-1):1,a===~~a){for(h=0,j=a;j>=10;j/=10,h++);h>F?o.c=o.e=null:(o.e=h,o.c=[a]);return}m=String(a)}else{if(!e.test(m=String(a)))return x(o,m,k);o.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(h=m.indexOf("."))>-1&&(m=m.replace(".","")),(j=m.search(/e/i))>0?(h<0&&(h=j),h+=+m.slice(j+1),m=m.substring(0,j)):h<0&&(h=m.length)}else{if(n(b,2,K.length,"Base"),10==b&&L)return Q(o=new M(a),A+o.e+1,B);if(m=String(a),k="number"==typeof a){if(0*a!=0)return x(o,m,k,b);if(o.s=1/a<0?(m=m.slice(1),-1):1,M.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(i+a)}else o.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(c=K.slice(0,b),h=j=0,l=m.length;j<l;j++)if(0>c.indexOf(d=m.charAt(j))){if("."==d){if(j>h){h=l;continue}}else if(!f&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){f=!0,j=-1,h=0;continue}return x(o,String(a),k,b)}k=!1,(h=(m=w(m,b,10,o.s)).indexOf("."))>-1?m=m.replace(".",""):h=m.length}for(j=0;48===m.charCodeAt(j);j++);for(l=m.length;48===m.charCodeAt(--l););if(m=m.slice(j,++l)){if(l-=j,k&&M.DEBUG&&l>15&&(a>0x1fffffffffffff||a!==g(a)))throw Error(i+o.s*a);if((h=h-j-1)>F)o.c=o.e=null;else if(h<E)o.c=[o.e=0];else{if(o.e=h,o.c=[],j=(h+1)%14,h<0&&(j+=14),j<l){for(j&&o.c.push(+m.slice(0,j)),l-=14;j<l;)o.c.push(+m.slice(j,j+=14));j=14-(m=m.slice(j)).length}else j-=l;for(;j--;m+="0");o.c.push(+m)}}else o.c=[o.e=0]}function N(a,b,c,d){var e,f,g,h,i;if(null==c?c=B:n(c,0,8),!a.c)return a.toString();if(e=a.c[0],g=a.e,null==b)i=l(a.c),i=1==d||2==d&&(g<=C||g>=D)?p(i,g):q(i,g,"0");else if(f=(a=Q(new M(a),b,c)).e,h=(i=l(a.c)).length,1==d||2==d&&(b<=f||f<=C)){for(;h<b;i+="0",h++);i=p(i,f)}else if(b-=g+(2===d&&f>g),i=q(i,f,"0"),f+1>h){if(--b>0)for(i+=".";b--;i+="0");}else if((b+=f-h)>0)for(f+1==h&&(i+=".");b--;i+="0");return a.s<0&&e?"-"+i:i}function O(a,b){for(var c,d,e=1,f=new M(a[0]);e<a.length;e++)(d=new M(a[e])).s&&(c=m(f,d))!==b&&(0!==c||f.s!==b)||(f=d);return f}function P(a,b,c){for(var d=1,e=b.length;!b[--e];b.pop());for(e=b[0];e>=10;e/=10,d++);return(c=d+14*c-1)>F?a.c=a.e=null:c<E?a.c=[a.e=0]:(a.e=c,a.c=b),a}function Q(a,b,c,d){var e,h,i,k,l,m,n,o=a.c;if(o){a:{for(e=1,k=o[0];k>=10;k/=10,e++);if((h=b-e)<0)h+=14,i=b,n=g((l=o[m=0])/j[e-i-1]%10);else if((m=f((h+1)/14))>=o.length)if(d){for(;o.length<=m;o.push(0));l=n=0,e=1,h%=14,i=h-14+1}else break a;else{for(e=1,l=k=o[m];k>=10;k/=10,e++);h%=14,n=(i=h-14+e)<0?0:g(l/j[e-i-1]%10)}if(d=d||b<0||null!=o[m+1]||(i<0?l:l%j[e-i-1]),d=c<4?(n||d)&&(0==c||c==(a.s<0?3:2)):n>5||5==n&&(4==c||d||6==c&&(h>0?i>0?l/j[e-i]:0:o[m-1])%10&1||c==(a.s<0?8:7)),b<1||!o[0])return o.length=0,d?(b-=a.e+1,o[0]=j[(14-b%14)%14],a.e=-b||0):o[0]=a.e=0,a;if(0==h?(o.length=m,k=1,m--):(o.length=m+1,k=j[14-h],o[m]=i>0?g(l/j[e-i]%j[i])*k:0),d)for(;;)if(0==m){for(h=1,i=o[0];i>=10;i/=10,h++);for(i=o[0]+=k,k=1;i>=10;i/=10,k++);h!=k&&(a.e++,1e14==o[0]&&(o[0]=1));break}else{if(o[m]+=k,1e14!=o[m])break;o[m--]=0,k=1}for(h=o.length;0===o[--h];o.pop());}a.e>F?a.c=a.e=null:a.e<E&&(a.c=[a.e=0])}return a}function R(a){var b,c=a.e;return null===c?a.toString():(b=l(a.c),b=c<=C||c>=D?p(b,c):q(b,c,"0"),a.s<0?"-"+b:b)}return M.clone=a,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(a){var b,c;if(null!=a)if("object"==typeof a){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(n(c=a[b],0,1e9,b),A=c),a.hasOwnProperty(b="ROUNDING_MODE")&&(n(c=a[b],0,8,b),B=c),a.hasOwnProperty(b="EXPONENTIAL_AT")&&((c=a[b])&&c.pop?(n(c[0],-1e9,0,b),n(c[1],0,1e9,b),C=c[0],D=c[1]):(n(c,-1e9,1e9,b),C=-(D=c<0?-c:c))),a.hasOwnProperty(b="RANGE"))if((c=a[b])&&c.pop)n(c[0],-1e9,-1,b),n(c[1],1,1e9,b),E=c[0],F=c[1];else if(n(c,-1e9,1e9,b),c)E=-(F=c<0?-c:c);else throw Error(h+b+" cannot be zero: "+c);if(a.hasOwnProperty(b="CRYPTO"))if(!!(c=a[b])===c)if(c)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=c;else throw G=!c,Error(h+"crypto unavailable");else G=c;else throw Error(h+b+" not true or false: "+c);if(a.hasOwnProperty(b="MODULO_MODE")&&(n(c=a[b],0,9,b),H=c),a.hasOwnProperty(b="POW_PRECISION")&&(n(c=a[b],0,1e9,b),I=c),a.hasOwnProperty(b="FORMAT"))if("object"==typeof(c=a[b]))J=c;else throw Error(h+b+" not an object: "+c);if(a.hasOwnProperty(b="ALPHABET")){if("string"!=typeof(c=a[b])||/^.?$|[+\-.\s]|(.).*\1/.test(c))throw Error(h+b+" invalid: "+c);L="0123456789"==c.slice(0,10),K=c}}else throw Error(h+"Object expected: "+a);return{DECIMAL_PLACES:A,ROUNDING_MODE:B,EXPONENTIAL_AT:[C,D],RANGE:[E,F],CRYPTO:G,MODULO_MODE:H,POW_PRECISION:I,FORMAT:J,ALPHABET:K}},M.isBigNumber=function(a){if(!a||!0!==a._isBigNumber)return!1;if(!M.DEBUG)return!0;var b,c,d=a.c,e=a.e,f=a.s;a:if("[object Array]"==({}).toString.call(d)){if((1===f||-1===f)&&e>=-1e9&&e<=1e9&&e===g(e)){if(0===d[0]){if(0===e&&1===d.length)return!0;break a}if((b=(e+1)%14)<1&&(b+=14),String(d[0]).length==b){for(b=0;b<d.length;b++)if((c=d[b])<0||c>=1e14||c!==g(c))break a;if(0!==c)return!0}}}else if(null===d&&null===e&&(null===f||1===f||-1===f))return!0;throw Error(h+"Invalid BigNumber: "+a)},M.maximum=M.max=function(){return O(arguments,-1)},M.minimum=M.min=function(){return O(arguments,1)},c=0x20000000000000*Math.random()&2097151?function(){return g(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},M.random=function(a){var b,d,e,i,k,l=0,m=[],o=new M(z);if(null==a?a=A:n(a,0,1e9),i=f(a/14),G)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(i*=2));l<i;)(k=131072*b[l]+(b[l+1]>>>11))>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[l]=d[0],b[l+1]=d[1]):(m.push(k%1e14),l+=2);l=i/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(i*=7);l<i;)(k=(31&b[l])*0x1000000000000+0x10000000000*b[l+1]+0x100000000*b[l+2]+0x1000000*b[l+3]+(b[l+4]<<16)+(b[l+5]<<8)+b[l+6])>=9e15?crypto.randomBytes(7).copy(b,l):(m.push(k%1e14),l+=7);l=i/7}else throw G=!1,Error(h+"crypto unavailable");if(!G)for(;l<i;)(k=c())<9e15&&(m[l++]=k%1e14);for(i=m[--l],a%=14,i&&a&&(k=j[14-a],m[l]=g(i/k)*k);0===m[l];m.pop(),l--);if(l<0)m=[e=0];else{for(e=-1;0===m[0];m.splice(0,1),e-=14);for(l=1,k=m[0];k>=10;k/=10,l++);l<14&&(e-=14-l)}return o.e=e,o.c=m,o},M.sum=function(){for(var a=1,b=arguments,c=new M(b[0]);a<b.length;)c=c.plus(b[a++]);return c},w=function(){var a="0123456789";function b(a,b,c,d){for(var e,f,g=[0],h=0,i=a.length;h<i;){for(f=g.length;f--;g[f]*=b);for(g[0]+=d.indexOf(a.charAt(h++)),e=0;e<g.length;e++)g[e]>c-1&&(null==g[e+1]&&(g[e+1]=0),g[e+1]+=g[e]/c|0,g[e]%=c)}return g.reverse()}return function(c,d,e,f,g){var h,i,j,k,m,n,o,p,r=c.indexOf("."),s=A,t=B;for(r>=0&&(k=I,I=0,c=c.replace(".",""),n=(p=new M(d)).pow(c.length-r),I=k,p.c=b(q(l(n.c),n.e,"0"),10,e,a),p.e=p.c.length),j=k=(o=b(c,d,e,g?(h=K,a):(h=a,K))).length;0==o[--k];o.pop());if(!o[0])return h.charAt(0);if(r<0?--j:(n.c=o,n.e=j,n.s=f,o=(n=v(n,p,s,t,e)).c,m=n.r,j=n.e),r=o[i=j+s+1],k=e/2,m=m||i<0||null!=o[i+1],m=t<4?(null!=r||m)&&(0==t||t==(n.s<0?3:2)):r>k||r==k&&(4==t||m||6==t&&1&o[i-1]||t==(n.s<0?8:7)),i<1||!o[0])c=m?q(h.charAt(1),-s,h.charAt(0)):h.charAt(0);else{if(o.length=i,m)for(--e;++o[--i]>e;)o[i]=0,i||(++j,o=[1].concat(o));for(k=o.length;!o[--k];);for(r=0,c="";r<=k;c+=h.charAt(o[r++]));c=q(c,j,h.charAt(0))}return c}}(),v=function(){function a(a,b,c){var d,e,f,g,h=0,i=a.length,j=b%1e7,k=b/1e7|0;for(a=a.slice();i--;)d=k*(f=a[i]%1e7)+(g=a[i]/1e7|0)*j,h=((e=j*f+d%1e7*1e7+h)/c|0)+(d/1e7|0)+k*g,a[i]=e%c;return h&&(a=[h].concat(a)),a}function b(a,b,c,d){var e,f;if(c!=d)f=c>d?1:-1;else for(e=f=0;e<c;e++)if(a[e]!=b[e]){f=a[e]>b[e]?1:-1;break}return f}function c(a,b,c,d){for(var e=0;c--;)a[c]-=e,e=+(a[c]<b[c]),a[c]=e*d+a[c]-b[c];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(d,e,f,h,i){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=d.s==e.s?1:-1,C=d.c,D=e.c;if(!C||!C[0]||!D||!D[0])return new M(!d.s||!e.s||(C?D&&C[0]==D[0]:!D)?NaN:C&&0==C[0]||!D?0*B:B/0);for(s=(r=new M(B)).c=[],B=f+(l=d.e-e.e)+1,i||(i=1e14,l=k(d.e/14)-k(e.e/14),B=B/14|0),m=0;D[m]==(C[m]||0);m++);if(D[m]>(C[m]||0)&&l--,B<0)s.push(1),n=!0;else{for(x=C.length,z=D.length,m=0,B+=2,(o=g(i/(D[0]+1)))>1&&(D=a(D,o,i),C=a(C,o,i),z=D.length,x=C.length),w=z,u=(t=C.slice(0,z)).length;u<z;t[u++]=0);A=[0].concat(A=D.slice()),y=D[0],D[1]>=i/2&&y++;do{if(o=0,(j=b(D,t,z,u))<0){if(v=t[0],z!=u&&(v=v*i+(t[1]||0)),(o=g(v/y))>1)for(o>=i&&(o=i-1),q=(p=a(D,o,i)).length,u=t.length;1==b(p,t,q,u);)o--,c(p,z<q?A:D,q,i),q=p.length,j=1;else 0==o&&(j=o=1),q=(p=D.slice()).length;if(q<u&&(p=[0].concat(p)),c(t,p,u,i),u=t.length,-1==j)for(;1>b(D,t,z,u);)o++,c(t,z<u?A:D,u,i),u=t.length}else 0===j&&(o++,t=[0]);s[m++]=o,t[0]?t[u++]=C[w]||0:(t=[C[w]],u=1)}while((w++<x||null!=t[0])&&B--)n=null!=t[0],s[0]||s.splice(0,1)}if(1e14==i){for(m=1,B=s[0];B>=10;B/=10,m++);Q(r,f+(r.e=m+14*l-1)+1,h,n)}else r.e=l,r.r=+n;return r}}(),d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,r=/^([^.]+)\.$/,s=/^\.([^.]+)$/,t=/^-?(Infinity|NaN)$/,u=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(a,b,c,e){var f,g=c?b:b.replace(u,"");if(t.test(g))a.s=isNaN(g)?null:g<0?-1:1;else{if(!c&&(g=g.replace(d,function(a,b,c){return f="x"==(c=c.toLowerCase())?16:"b"==c?2:8,e&&e!=f?a:b}),e&&(f=e,g=g.replace(r,"$1").replace(s,"0.$1")),b!=g))return new M(g,f);if(M.DEBUG)throw Error(h+"Not a"+(e?" base "+e:"")+" number: "+b);a.s=null}a.c=a.e=null},y.absoluteValue=y.abs=function(){var a=new M(this);return a.s<0&&(a.s=1),a},y.comparedTo=function(a,b){return m(this,new M(a,b))},y.decimalPlaces=y.dp=function(a,b){var c,d,e;if(null!=a)return n(a,0,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a+this.e+1,b);if(!(c=this.c))return null;if(d=((e=c.length-1)-k(this.e/14))*14,e=c[e])for(;e%10==0;e/=10,d--);return d<0&&(d=0),d},y.dividedBy=y.div=function(a,b){return v(this,new M(a,b),A,B)},y.dividedToIntegerBy=y.idiv=function(a,b){return v(this,new M(a,b),0,1)},y.exponentiatedBy=y.pow=function(a,b){var c,d,e,i,j,k,l,m,n,p=this;if((a=new M(a)).c&&!a.isInteger())throw Error(h+"Exponent not an integer: "+R(a));if(null!=b&&(b=new M(b)),k=a.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!a.c||!a.c[0])return n=new M(Math.pow(+R(p),k?a.s*(2-o(a)):+R(a))),b?n.mod(b):n;if(l=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new M(NaN);(d=!l&&p.isInteger()&&b.isInteger())&&(p=p.mod(b))}else{if(a.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||k&&p.c[1]>=24e7:p.c[0]<8e13||k&&p.c[0]<=9999975e7)))return i=p.s<0&&o(a)?-0:0,p.e>-1&&(i=1/i),new M(l?1/i:i);I&&(i=f(I/14+2))}for(k?(c=new M(.5),l&&(a.s=1),m=o(a)):m=(e=Math.abs(+R(a)))%2,n=new M(z);;){if(m){if(!(n=n.times(p)).c)break;i?n.c.length>i&&(n.c.length=i):d&&(n=n.mod(b))}if(e){if(0===(e=g(e/2)))break;m=e%2}else if(Q(a=a.times(c),a.e+1,1),a.e>14)m=o(a);else{if(0==(e=+R(a)))break;m=e%2}p=p.times(p),i?p.c&&p.c.length>i&&(p.c.length=i):d&&(p=p.mod(b))}return d?n:(l&&(n=z.div(n)),b?n.mod(b):i?Q(n,I,B,j):n)},y.integerValue=function(a){var b=new M(this);return null==a?a=B:n(a,0,8),Q(b,b.e+1,a)},y.isEqualTo=y.eq=function(a,b){return 0===m(this,new M(a,b))},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(a,b){return m(this,new M(a,b))>0},y.isGreaterThanOrEqualTo=y.gte=function(a,b){return 1===(b=m(this,new M(a,b)))||0===b},y.isInteger=function(){return!!this.c&&k(this.e/14)>this.c.length-2},y.isLessThan=y.lt=function(a,b){return 0>m(this,new M(a,b))},y.isLessThanOrEqualTo=y.lte=function(a,b){return -1===(b=m(this,new M(a,b)))||0===b},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return this.s>0},y.isZero=function(){return!!this.c&&0==this.c[0]},y.minus=function(a,b){var c,d,e,f,g=this.s;if(b=(a=new M(a,b)).s,!g||!b)return new M(NaN);if(g!=b)return a.s=-b,this.plus(a);var h=this.e/14,i=a.e/14,j=this.c,l=a.c;if(!h||!i){if(!j||!l)return j?(a.s=-b,a):new M(l?this:NaN);if(!j[0]||!l[0])return l[0]?(a.s=-b,a):new M(j[0]?this:3==B?-0:0)}if(h=k(h),i=k(i),j=j.slice(),g=h-i){for((f=g<0)?(g=-g,e=j):(i=h,e=l),e.reverse(),b=g;b--;e.push(0));e.reverse()}else for(d=(f=(g=j.length)<(b=l.length))?g:b,g=b=0;b<d;b++)if(j[b]!=l[b]){f=j[b]<l[b];break}if(f&&(e=j,j=l,l=e,a.s=-a.s),(b=(d=l.length)-(c=j.length))>0)for(;b--;j[c++]=0);for(b=1e14-1;d>g;){if(j[--d]<l[d]){for(c=d;c&&!j[--c];j[c]=b);--j[c],j[d]+=1e14}j[d]-=l[d]}for(;0==j[0];j.splice(0,1),--i);return j[0]?P(a,j,i):(a.s=3==B?-1:1,a.c=[a.e=0],a)},y.modulo=y.mod=function(a,b){var c,d;return(a=new M(a,b),this.c&&a.s&&(!a.c||a.c[0]))?a.c&&(!this.c||this.c[0])?(9==H?(d=a.s,a.s=1,c=v(this,a,0,3),a.s=d,c.s*=d):c=v(this,a,0,H),(a=this.minus(c.times(a))).c[0]||1!=H||(a.s=this.s),a):new M(this):new M(NaN)},y.multipliedBy=y.times=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q=this.c,r=(a=new M(a,b)).c;if(!q||!r||!q[0]||!r[0])return this.s&&a.s&&(!q||q[0]||r)&&(!r||r[0]||q)?(a.s*=this.s,q&&r?(a.c=[0],a.e=0):a.c=a.e=null):a.c=a.e=a.s=null,a;for(d=k(this.e/14)+k(a.e/14),a.s*=this.s,(i=q.length)<(m=r.length)&&(p=q,q=r,r=p,e=i,i=m,m=e),e=i+m,p=[];e--;p.push(0));for(e=m;--e>=0;){for(c=0,n=r[e]%1e7,o=r[e]/1e7|0,f=e+(g=i);f>e;)h=o*(j=q[--g]%1e7)+(l=q[g]/1e7|0)*n,c=((j=n*j+h%1e7*1e7+p[f]+c)/1e14|0)+(h/1e7|0)+o*l,p[f--]=j%1e14;p[f]=c}return c?++d:p.splice(0,1),P(a,p,d)},y.negated=function(){var a=new M(this);return a.s=-a.s||null,a},y.plus=function(a,b){var c,d=this.s;if(b=(a=new M(a,b)).s,!d||!b)return new M(NaN);if(d!=b)return a.s=-b,this.minus(a);var e=this.e/14,f=a.e/14,g=this.c,h=a.c;if(!e||!f){if(!g||!h)return new M(d/0);if(!g[0]||!h[0])return h[0]?a:new M(g[0]?this:0*d)}if(e=k(e),f=k(f),g=g.slice(),d=e-f){for(d>0?(f=e,c=h):(d=-d,c=g),c.reverse();d--;c.push(0));c.reverse()}for((d=g.length)-(b=h.length)<0&&(c=h,h=g,g=c,b=d),d=0;b;)d=(g[--b]=g[b]+h[b]+d)/1e14|0,g[b]=1e14===g[b]?0:g[b]%1e14;return d&&(g=[d].concat(g),++f),P(a,g,f)},y.precision=y.sd=function(a,b){var c,d,e;if(null!=a&&!!a!==a)return n(a,1,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a,b);if(!(c=this.c))return null;if(d=14*(e=c.length-1)+1,e=c[e]){for(;e%10==0;e/=10,d--);for(e=c[0];e>=10;e/=10,d++);}return a&&this.e+1>d&&(d=this.e+1),d},y.shiftedBy=function(a){return n(a,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+a)},y.squareRoot=y.sqrt=function(){var a,b,c,d,e,f=this.c,g=this.s,h=this.e,i=A+4,j=new M("0.5");if(1!==g||!f||!f[0])return new M(!g||g<0&&(!f||f[0])?NaN:f?this:1/0);if(0==(g=Math.sqrt(+R(this)))||g==1/0?(((b=l(f)).length+h)%2==0&&(b+="0"),g=Math.sqrt(+b),h=k((h+1)/2)-(h<0||h%2),c=new M(b=g==1/0?"5e"+h:(b=g.toExponential()).slice(0,b.indexOf("e")+1)+h)):c=new M(g+""),c.c[0]){for((g=(h=c.e)+i)<3&&(g=0);;)if(e=c,c=j.times(e.plus(v(this,e,i,1))),l(e.c).slice(0,g)===(b=l(c.c)).slice(0,g)){if(c.e<h&&--g,"9999"!=(b=b.slice(g-3,g+1))&&(d||"4999"!=b)){+b&&(+b.slice(1)||"5"!=b.charAt(0))||(Q(c,c.e+A+2,1),a=!c.times(c).eq(this));break}if(!d&&(Q(e,e.e+A+2,0),e.times(e).eq(this))){c=e;break}i+=4,g+=4,d=1}}return Q(c,c.e+A+1,B,a)},y.toExponential=function(a,b){return null!=a&&(n(a,0,1e9),a++),N(this,a,b,1)},y.toFixed=function(a,b){return null!=a&&(n(a,0,1e9),a=a+this.e+1),N(this,a,b)},y.toFormat=function(a,b,c){var d;if(null==c)null!=a&&b&&"object"==typeof b?(c=b,b=null):a&&"object"==typeof a?(c=a,a=b=null):c=J;else if("object"!=typeof c)throw Error(h+"Argument not an object: "+c);if(d=this.toFixed(a,b),this.c){var e,f=d.split("."),g=+c.groupSize,i=+c.secondaryGroupSize,j=c.groupSeparator||"",k=f[0],l=f[1],m=this.s<0,n=m?k.slice(1):k,o=n.length;if(i&&(e=g,g=i,i=e,o-=e),g>0&&o>0){for(e=o%g||g,k=n.substr(0,e);e<o;e+=g)k+=j+n.substr(e,g);i>0&&(k+=j+n.slice(e)),m&&(k="-"+k)}d=l?k+(c.decimalSeparator||"")+((i=+c.fractionGroupSize)?l.replace(RegExp("\\d{"+i+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):l):k}return(c.prefix||"")+d+(c.suffix||"")},y.toFraction=function(a){var b,c,d,e,f,g,i,k,m,n,o,p,q=this.c;if(null!=a&&(!(i=new M(a)).isInteger()&&(i.c||1!==i.s)||i.lt(z)))throw Error(h+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+R(i));if(!q)return new M(this);for(b=new M(z),m=c=new M(z),d=k=new M(z),p=l(q),f=b.e=p.length-this.e-1,b.c[0]=j[(g=f%14)<0?14+g:g],a=!a||i.comparedTo(b)>0?f>0?b:m:i,g=F,F=1/0,i=new M(p),k.c[0]=0;n=v(i,b,0,1),1!=(e=c.plus(n.times(d))).comparedTo(a);)c=d,d=e,m=k.plus(n.times(e=m)),k=e,b=i.minus(n.times(e=b)),i=e;return e=v(a.minus(c),d,0,1),k=k.plus(e.times(m)),c=c.plus(e.times(d)),k.s=m.s=this.s,f*=2,o=1>v(m,d,f,B).minus(this).abs().comparedTo(v(k,c,f,B).minus(this).abs())?[m,d]:[k,c],F=g,o},y.toNumber=function(){return+R(this)},y.toPrecision=function(a,b){return null!=a&&n(a,1,1e9),N(this,a,b,2)},y.toString=function(a){var b,c=this,d=c.s,e=c.e;return null===e?d?(b="Infinity",d<0&&(b="-"+b)):b="NaN":(null==a?b=e<=C||e>=D?p(l(c.c),e):q(l(c.c),e,"0"):10===a&&L?b=q(l((c=Q(new M(c),A+e+1,B)).c),c.e,"0"):(n(a,2,K.length,"Base"),b=w(q(l(c.c),e,"0"),10,a,d,!0)),d<0&&c.c[0]&&(b="-"+b)),b},y.valueOf=y.toJSON=function(){return R(this)},y._isBigNumber=!0,null!=b&&M.set(b),M}()).default=d.BigNumber=d,"function"==typeof define&&define.amd)a.r,void 0!==d&&a.v(d);else b.exports?b.exports=d:(c||(c="undefined"!=typeof self&&self?self:window),c.BigNumber=d)}(a.e)},47006,(a,b,c)=>{var d=a.r(30168),e=b.exports;!function(){"use strict";var a,b,c,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function h(a){return f.lastIndex=0,f.test(a)?'"'+a.replace(f,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof e.stringify&&(e.stringify=function(e,f,g){var i;if(a="",b="","number"==typeof g)for(i=0;i<g;i+=1)b+=" ";else"string"==typeof g&&(b=g);if(c=f,f&&"function"!=typeof f&&("object"!=typeof f||"number"!=typeof f.length))throw Error("JSON.stringify");return function e(f,g){var i,j,k,l,m,n=a,o=g[f],p=null!=o&&(o instanceof d||d.isBigNumber(o));switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(f)),"function"==typeof c&&(o=c.call(g,f,o)),typeof o){case"string":if(p)return o;return h(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":case"bigint":return String(o);case"object":if(!o)return"null";if(a+=b,m=[],"[object Array]"===Object.prototype.toString.apply(o)){for(i=0,l=o.length;i<l;i+=1)m[i]=e(i,o)||"null";return k=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+n+"]":"["+m.join(",")+"]",a=n,k}if(c&&"object"==typeof c)for(i=0,l=c.length;i<l;i+=1)"string"==typeof c[i]&&(k=e(j=c[i],o))&&m.push(h(j)+(a?": ":":")+k);else Object.keys(o).forEach(function(b){var c=e(b,o);c&&m.push(h(b)+(a?": ":":")+c)});return k=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+n+"}":"{"+m.join(",")+"}",a=n,k}}("",{"":e})})}()},27545,(a,b,c)=>{var d=null;let e=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,f=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;b.exports=function(b){"use strict";var c={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=b){if(!0===b.strict&&(c.strict=!0),!0===b.storeAsString&&(c.storeAsString=!0),c.alwaysParseAsBig=!0===b.alwaysParseAsBig&&b.alwaysParseAsBig,c.useNativeBigInt=!0===b.useNativeBigInt&&b.useNativeBigInt,void 0!==b.constructorAction)if("error"===b.constructorAction||"ignore"===b.constructorAction||"preserve"===b.constructorAction)c.constructorAction=b.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${b.constructorAction}`);if(void 0!==b.protoAction)if("error"===b.protoAction||"ignore"===b.protoAction||"preserve"===b.protoAction)c.protoAction=b.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${b.protoAction}`)}var g,h,i,j,k={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(a){throw{name:"SyntaxError",message:a,at:g,text:i}},m=function(a){return a&&a!==h&&l("Expected '"+a+"' instead of '"+h+"'"),h=i.charAt(g),g+=1,h},n=function(){var b,e="";for("-"===h&&(e="-",m("-"));h>="0"&&h<="9";)e+=h,m();if("."===h)for(e+=".";m()&&h>="0"&&h<="9";)e+=h;if("e"===h||"E"===h)for(e+=h,m(),("-"===h||"+"===h)&&(e+=h,m());h>="0"&&h<="9";)e+=h,m();if(isFinite(b=+e))return(null==d&&(d=a.r(30168)),e.length>15)?c.storeAsString?e:c.useNativeBigInt?BigInt(e):new d(e):c.alwaysParseAsBig?c.useNativeBigInt?BigInt(b):new d(b):b;l("Bad number")},o=function(){var a,b,c,d="";if('"'===h)for(var e=g;m();){if('"'===h)return g-1>e&&(d+=i.substring(e,g-1)),m(),d;if("\\"===h){if(g-1>e&&(d+=i.substring(e,g-1)),m(),"u"===h){for(b=0,c=0;b<4&&isFinite(a=parseInt(m(),16));b+=1)c=16*c+a;d+=String.fromCharCode(c)}else if("string"==typeof k[h])d+=k[h];else break;e=g}}l("Bad string")},p=function(){for(;h&&h<=" ";)m()},q=function(){switch(h){case"t":return m("t"),m("r"),m("u"),m("e"),!0;case"f":return m("f"),m("a"),m("l"),m("s"),m("e"),!1;case"n":return m("n"),m("u"),m("l"),m("l"),null}l("Unexpected '"+h+"'")},r=function(){var a=[];if("["===h){if(m("["),p(),"]"===h)return m("]"),a;for(;h;){if(a.push(j()),p(),"]"===h)return m("]"),a;m(","),p()}}l("Bad array")},s=function(){var a,b=Object.create(null);if("{"===h){if(m("{"),p(),"}"===h)return m("}"),b;for(;h;){if(a=o(),p(),m(":"),!0===c.strict&&Object.hasOwnProperty.call(b,a)&&l('Duplicate key "'+a+'"'),!0===e.test(a)?"error"===c.protoAction?l("Object contains forbidden prototype property"):"ignore"===c.protoAction?j():b[a]=j():!0===f.test(a)?"error"===c.constructorAction?l("Object contains forbidden constructor property"):"ignore"===c.constructorAction?j():b[a]=j():b[a]=j(),p(),"}"===h)return m("}"),b;m(","),p()}}l("Bad object")};return j=function(){switch(p(),h){case"{":return s();case"[":return r();case'"':return o();case"-":return n();default:return h>="0"&&h<="9"?n():q()}},function(a,b){var c;return i=a+"",g=0,h=" ",c=j(),p(),h&&l("Syntax error"),"function"==typeof b?function a(c,d){var e,f=c[d];return f&&"object"==typeof f&&Object.keys(f).forEach(function(b){void 0!==(e=a(f,b))?f[b]=e:delete f[b]}),b.call(c,d,f)}({"":c},""):c}}},31553,(a,b,c)=>{var d=a.r(47006).stringify,e=a.r(27545);b.exports=function(a){return{parse:e(a),stringify:d}},b.exports.parse=e(),b.exports.stringify=d},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},5365,(a,b,c)=>{b.exports=a.x("process",()=>require("process"))},22852,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Colours=void 0;class d{static isEnabled(a){return a&&a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){d.enabled=d.isEnabled(null==process?void 0:process.stderr),this.enabled?(d.reset="\x1b[0m",d.bright="\x1b[1m",d.dim="\x1b[2m",d.red="\x1b[31m",d.green="\x1b[32m",d.yellow="\x1b[33m",d.blue="\x1b[34m",d.magenta="\x1b[35m",d.cyan="\x1b[36m",d.white="\x1b[37m",d.grey="\x1b[90m"):(d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="")}}c.Colours=d,d.enabled=!1,d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="",d.refresh()},91100,(a,b,c)=>{"use strict";let d;var e,f,g,h=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),i=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),j=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&h(b,a,c[d]);return i(b,a),b});Object.defineProperty(c,"__esModule",{value:!0}),c.env=c.DebugLogBackendBase=c.placeholder=c.AdhocDebugLogger=c.LogSeverity=void 0,c.getNodeBackend=r,c.getDebugBackend=function(a){return new s(a)},c.getStructuredBackend=function(a){return new t(a)},c.setBackend=function(a){d=a,u.clear()},c.log=v;let k=a.r(27699),l=j(a.r(5365)),m=j(a.r(24361)),n=a.r(22852);(f=g||(c.LogSeverity=g={})).DEFAULT="DEFAULT",f.DEBUG="DEBUG",f.INFO="INFO",f.WARNING="WARNING",f.ERROR="ERROR";class o extends k.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(g.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(g.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(g.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(g.ERROR,...a),this.func.sublog=a=>v(a,this.func)}invoke(a,...b){if(this.upstream)try{this.upstream(a,...b)}catch(a){}try{this.emit("log",a,b)}catch(a){}}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}c.AdhocDebugLogger=o,c.placeholder=new o("",()=>{}).func;class p{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let b=null!=(a=l.env[c.env.nodeEnables])?a:"*";"all"===b&&(b="*"),this.filters=b.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}c.DebugLogBackendBase=p;class q extends p{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let e,f=`${n.Colours.green}${a}${n.Colours.reset}`,h=`${n.Colours.yellow}${l.pid}${n.Colours.reset}`;switch(b.severity){case g.ERROR:e=`${n.Colours.red}${b.severity}${n.Colours.reset}`;break;case g.INFO:e=`${n.Colours.magenta}${b.severity}${n.Colours.reset}`;break;case g.WARNING:e=`${n.Colours.yellow}${b.severity}${n.Colours.reset}`;break;default:e=null!=(d=b.severity)?d:g.DEFAULT}let i=m.formatWithOptions({colors:n.Colours.enabled},...c),j=Object.assign({},b);delete j.severity;let k=Object.getOwnPropertyNames(j).length?JSON.stringify(j):"",o=k?`${n.Colours.grey}${k}${n.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,f,e,i,k?` ${o}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function r(){return new q}class s extends p{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=l.env.NODE_DEBUG)?a:"";l.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class t extends p{constructor(a){super(),this.upstream=null!=a?a:void 0}makeLogger(a){var b;let c=null==(b=this.upstream)?void 0:b.makeLogger(a);return(a,...b)=>{var d;let e=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:g.INFO,message:m.format(...b)},a));c?c(a,e):console.log("%s",e)}}setFilters(){var a;null==(a=this.upstream)||a.setFilters()}}c.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let u=new Map;function v(a,b){let e;if(!d&&!l.env[c.env.nodeEnables]||!a)return c.placeholder;b&&(a=`${b.instance.namespace}:${a}`);let f=u.get(a);if(f)return f.func;if(null===d)return c.placeholder;void 0===d&&(d=r());let g=new o(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=r()),e=d}null==d||d.log(a,b,...c)});return u.set(a,g),g.func}},15979,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(91100),c)},40411,(a,b,c)=>{"use strict";let d;var e,f=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),g=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),h=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&f(b,a,c[d]);return g(b,a),b}),i=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||f(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.gcpResidencyCache=c.METADATA_SERVER_DETECTION=c.HEADERS=c.HEADER_VALUE=c.HEADER_NAME=c.SECONDARY_HOST_ADDRESS=c.HOST_ADDRESS=c.BASE_PATH=void 0,c.instance=function(a){return p("instance",a)},c.project=function(a){return p("project",a)},c.universe=function(a){return p("universe",a)},c.bulk=r,c.isAvailable=s,c.resetIsAvailableCache=function(){d=void 0},c.getGCPResidency=t,c.setGCPResidency=u,c.requestTimeout=v;let j=a.r(99853),k=a.r(31553),l=a.r(85364),m=h(a.r(15979));c.BASE_PATH="/computeMetadata/v1",c.HOST_ADDRESS="http://169.254.169.254",c.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",c.HEADER_NAME="Metadata-Flavor",c.HEADER_VALUE="Google",c.HEADERS=Object.freeze({[c.HEADER_NAME]:c.HEADER_VALUE});let n=m.log("gcp-metadata");function o(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||c.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(c.BASE_PATH,a).href}async function p(a,b={},d=3,e=!1){let f=new Headers(c.HEADERS),g="",h={};("object"==typeof a?(new Headers(a.headers).forEach((a,b)=>f.set(b,a)),g=a.metadataKey,h=a.params||h,d=a.noResponseRetries||d,e=a.fastFail||e):g=a,"string"==typeof b)?g+=`/${b}`:(Object.keys(b).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),b.property&&(g+=`/${b.property}`),new Headers(b.headers).forEach((a,b)=>f.set(b,a)),h=b.params||h);let i=e?q:j.request,l={url:`${o()}/${g}`,headers:f,retryConfig:{noResponseRetries:d},params:h,responseType:"text",timeout:v()};n.info("instance request %j",l);let m=await i(l);n.info("instance metadata is %s",m.data);let r=m.headers.get(c.HEADER_NAME);if(r!==c.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${c.HEADER_NAME} header. Expected '${c.HEADER_VALUE}', got ${r?`'${r}'`:"no header"}`);if("string"==typeof m.data)try{return k.parse(m.data)}catch{}return m.data}async function q(a){let b={...a,url:a.url?.toString().replace(o(),o(c.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,j.request)(a),(0,j.request)(b)])}async function r(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await p(a);b[a.metadataKey]=c})())),b}async function s(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in c.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(c.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return t()}}try{return void 0===d&&(d=p("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code.toString()))){let b="UNKNOWN";a.code&&(b=a.code.toString()),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function t(){return null===c.gcpResidencyCache&&u(),c.gcpResidencyCache}function u(a=null){c.gcpResidencyCache=null!==a?a:(0,l.detectGCPResidency)()}function v(){return 3e3*!t()}c.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),c.gcpResidencyCache=null,i(a.r(85364),c)},35863,(a,b,c)=>{"use strict";c.byteLength=function(a){var b=j(a),c=b[0],d=b[1];return(c+d)*3/4-d},c.toByteArray=function(a){var b,c,d=j(a),g=d[0],h=d[1],i=new f((g+h)*3/4-h),k=0,l=h>0?g-4:g;for(c=0;c<l;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],i[k++]=b>>16&255,i[k++]=b>>8&255,i[k++]=255&b;return 2===h&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,i[k++]=255&b),1===h&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,i[k++]=b>>8&255,i[k++]=255&b),i},c.fromByteArray=function(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(function(a,b,c){for(var e,f=[],g=b;g<c;g+=3)e=(a[g]<<16&0xff0000)+(a[g+1]<<8&65280)+(255&a[g+2]),f.push(d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]);return f.join("")}(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")};for(var d=[],e=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,i=g.length;h<i;++h)d[h]=g[h],e[g.charCodeAt(h)]=h;function j(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}e[45]=62,e[95]=63},66051,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")}},26410,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BrowserCrypto=void 0;let d=a.r(35863),e=a.r(66051);class f{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}c.BrowserCrypto=f},66414,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NodeCrypto=void 0;let d=a.r(54799);c.NodeCrypto=class{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}},65726,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.createCrypto=function(){return function(){;}(),new f.NodeCrypto},c.hasBrowserCrypto=g,a.r(26410);let f=a.r(66414);function g(){return!1}e(a.r(66051),c)},45706,(a,b,c)=>{b.exports=a.x("querystring",()=>require("querystring"))},74898,(a,b,c)=>{var d=a.r(874),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?b.exports=d:(f(d,c),c.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},79106,(a,b,c)=>{"use strict";function d(a){return(a/8|0)+ +(a%8!=0)}var e={ES256:d(256),ES384:d(384),ES512:d(521)};b.exports=function(a){var b=e[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},8863,(a,b,c)=>{"use strict";var d=a.r(74898).Buffer,e=a.r(79106);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}b.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var n=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var o=c-k,p=c-m,q=d.allocUnsafe(o+k+p+m);for(i=0;i<o;++i)q[i]=0;a.copy(q,i,l+Math.max(-o,0),l+k),i=c;for(var r=i;i<r+p;++i)q[i]=0;return a.copy(q,i,n+Math.max(-p,0),n+m),q=(q=q.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,n=m<128,o=d.allocUnsafe((n?2:3)+m),p=0;return o[p++]=48,n?o[p++]=m:(o[p++]=129,o[p++]=255&m),o[p++]=2,o[p++]=k,i<0?(o[p++]=0,p+=a.copy(o,p,0,c)):p+=a.copy(o,p,i,c),o[p++]=2,o[p++]=l,j<0?(o[p++]=0,a.copy(o,p,c)):a.copy(o,p,c+j),o}}},98126,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LRUCache=void 0,c.snakeToCamel=h,c.originalOrCamelOptions=function(a){return{get:function(b){let c=a||{};return c[b]??c[h(b)]}}},c.removeUndefinedValuesInObject=function(a){return Object.entries(a).forEach(([b,c])=>{(void 0===c||"undefined"===c)&&delete a[b]}),a},c.isValidFile=j,c.getWellKnownCertificateConfigFileLocation=function(){let a=process.env.CLOUDSDK_CONFIG||(e.platform().startsWith("win")?f.join(process.env.APPDATA||"",g):f.join(process.env.HOME||"",".config",g));return f.join(a,"certificate_config.json")};let d=a.r(22734),e=a.r(46786),f=a.r(14747),g="gcloud";function h(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}class i{capacity;#j=new Map;maxAge;constructor(a){this.capacity=a.capacity,this.maxAge=a.maxAge}#k(a,b){this.#j.delete(a),this.#j.set(a,{value:b,lastAccessed:Date.now()})}set(a,b){this.#k(a,b),this.#l()}get(a){let b=this.#j.get(a);if(b)return this.#k(a,b.value),this.#l(),b.value}#l(){let a=this.maxAge?Date.now()-this.maxAge:0,b=this.#j.entries().next();for(;!b.done&&(this.#j.size>this.capacity||b.value[1].lastAccessed<a);)this.#j.delete(b.value[0]),b=this.#j.entries().next()}}async function j(a){try{return(await d.promises.lstat(a)).isFile()}catch(a){return!1}}c.LRUCache=i},91829,a=>{a.v({name:"google-auth-library",version:"10.5.0",author:"Google Inc.",description:"Google APIs Authentication Client Library for Node.js",engines:{node:">=18"},main:"./build/src/index.js",types:"./build/src/index.d.ts",repository:"googleapis/google-auth-library-nodejs.git",keywords:["google","api","google apis","client","client library"],dependencies:{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11",gaxios:"^7.0.0","gcp-metadata":"^8.0.0","google-logging-utils":"^1.0.0",gtoken:"^8.0.0",jws:"^4.0.0"},devDependencies:{"@types/base64-js":"^1.2.5","@types/jws":"^3.1.0","@types/mocha":"^10.0.10","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0",c8:"^10.0.0",codecov:"^3.0.2",gts:"^6.0.0","is-docker":"^3.0.0",jsdoc:"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1",keypair:"^1.0.4",mocha:"^11.1.0",mv:"^2.1.1",ncp:"^2.0.0",nock:"^14.0.5","null-loader":"^4.0.0",puppeteer:"^24.0.0",sinon:"^21.0.0","ts-loader":"^8.0.0",typescript:"5.8.2",webpack:"^5.21.2","webpack-cli":"^4.0.0"},files:["build/src","!build/src/**/*.map"],scripts:{test:"c8 mocha build/test",clean:"gts clean",prepare:"npm run compile",lint:"gts check --no-inline-config",compile:"tsc -p .",fix:"gts fix",pretest:"npm run compile -- --sourceMap",docs:"jsdoc -c .jsdoc.js","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap",webpack:"webpack","browser-test":"karma start","docs-test":"echo 'disabled until linkinator is fixed'","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install"},license:"Apache-2.0"})},15204,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.USER_AGENT=c.PRODUCT_NAME=c.pkg=void 0;let d=a.r(91829);c.pkg=d;let e="google-api-nodejs-client";c.PRODUCT_NAME=e,c.USER_AGENT=`${e}/${d.version}`},30190,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AuthClient=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=c.DEFAULT_UNIVERSE=void 0;let d=a.r(27699),e=a.r(99853),f=a.r(98126),g=a.r(15979),h=a.r(15204);c.DEFAULT_UNIVERSE="googleapis.com",c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class i extends d.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=c.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(a={}){super();const b=(0,f.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=b.get("project_id")??null,this.quotaProjectId=b.get("quota_project_id"),this.credentials=b.get("credentials")??{},this.universeDomain=b.get("universe_domain")??c.DEFAULT_UNIVERSE,this.transporter=a.transporter??new e.Gaxios(a.transporterOptions),!1!==b.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(i.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(i.DEFAULT_RESPONSE_INTERCEPTOR)),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=a.forceRefreshOnFailure??!1}fetch(...a){let b,c=a[0],d=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&e.Gaxios.mergeHeaders(f,c.headers),d&&e.Gaxios.mergeHeaders(f,new Headers(d.headers)),"object"!=typeof c||c instanceof URL)?this.request({...d,headers:f,url:b}):this.request({...d,...c,headers:f,url:b})}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a.has("x-goog-user-project")&&this.quotaProjectId&&a.set("x-goog-user-project",this.quotaProjectId),a}addUserProjectAndAuthHeaders(a,b){let c=b.get("x-goog-user-project"),d=b.get("authorization");return c&&a.set("x-goog-user-project",c),d&&a.set("authorization",d),a}static log=(0,g.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async a=>{if(!a.headers.has("x-goog-api-client")){let b=process.version.replace(/^v/,"");a.headers.set("x-goog-api-client",`gl-node/${b}`)}let b=a.headers.get("User-Agent");b?b.includes(`${h.PRODUCT_NAME}/`)||a.headers.set("User-Agent",`${b} ${h.USER_AGENT}`):a.headers.set("User-Agent",h.USER_AGENT);try{let b=a[i.RequestMethodNameSymbol],c=`${Math.floor(1e3*Math.random())}`;a[i.RequestLogIdSymbol]=c;let d={url:a.url,headers:a.headers};b?i.log.info("%s [%s] request %j",b,c,d):i.log.info("[%s] request %j",c,d)}catch(a){}return a}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] response %j",c,d,a.data):i.log.info("[%s] response %j",d,a.data)}catch(a){}return a},rejected:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] error %j",c,d,a.response?.data):i.log.error("[%s] error %j",d,a.response?.data)}catch(a){}throw a}};static setMethodName(a,b){try{a[i.RequestMethodNameSymbol]=b}catch(a){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.AuthClient=i},98463,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LoginTicket=void 0,c.LoginTicket=class{envelope;payload;constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},94347,(a,b,c)=>{"use strict";var d,e,f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),c.OAuth2Client=c.ClientAuthentication=c.CertificateFormat=c.CodeChallengeMethod=void 0;let j=a.r(99853),k=a.r(45706),l=a.r(88947),m=a.r(8863),n=a.r(98126),o=a.r(65726),p=a.r(30190),q=a.r(98463);(g=d||(c.CodeChallengeMethod=d={})).Plain="plain",g.S256="S256",(h=e||(c.CertificateFormat=e={})).PEM="PEM",h.JWK="JWK",(i=f||(c.ClientAuthentication=f={})).ClientSecretPost="ClientSecretPost",i.ClientSecretBasic="ClientSecretBasic",i.None="None";class r extends p.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=e.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(a={},b,c){super("object"==typeof a?a:{}),"object"!=typeof a&&(a={clientId:a,clientSecret:b,redirectUri:c}),this._clientId=a.clientId||a.client_id,this._clientSecret=a.clientSecret||a.client_secret,this.redirectUri=a.redirectUri||a.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...a.endpoints},this.clientAuthentication=a.clientAuthentication||f.ClientSecretPost,this.issuers=a.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+k.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,o.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c=new Headers,d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.set("authorization",`Basic ${a.toString("base64")}`)}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e={...r.RETRY_CONFIG,method:"POST",url:b,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d)),headers:c};p.AuthClient.setMethodName(e,"getTokenAsync");let g=await this.transporter.request(e),h=g.data;return g.data&&g.data.expires_in&&(h.expiry_date=new Date().getTime()+1e3*g.data.expires_in,delete h.expires_in),this.emit("tokens",h),{tokens:h,res:g}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){let b;if(!a)throw Error("No refresh token is set.");let c=this.endpoints.oauth2TokenUrl.toString(),d={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let a={...r.RETRY_CONFIG,method:"POST",url:c,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d))};p.AuthClient.setMethodName(a,"refreshTokenNoCache"),b=await this.transporter.request(a)}catch(a){throw a instanceof j.GaxiosError&&"invalid_grant"===a.message&&a.response?.data&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let e=b.data;return b.data&&b.data.expires_in&&(e.expiry_date=new Date().getTime()+1e3*b.data.expires_in,delete e.expires_in),this.emit("tokens",e),{tokens:e,res:b}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a=new Headers({authorization:b.token_type+" "+b.access_token});return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token){this.setCredentials(a);let b=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f=new Headers({authorization:e.token_type+" "+d.access_token});return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new r().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...r.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(p.AuthClient.setMethodName(c,"revokeToken"),!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){try{let b=await this.getRequestMetadataAsync();return a.headers=j.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b.headers),this.apiKey&&a.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof l.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return b?.access_token&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...r.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,o.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getFederatedSignonCertsAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?.headers.get("cache-control"),g=-1;if(f){let a=/max-age=(?<maxAge>[0-9]+)/.exec(f)?.groups?.maxAge;a&&(g=1e3*Number(a))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getIapPublicKeysAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,o.createCrypto)();e||(e=r.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let j=i[0]+"."+i[1],k=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let l=b[f.kid];if("ES256"===f.alg&&(k=m.joseToDer(k,"ES256").toString("base64")),!await h.verify(l,j,k))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let n=Number(g.iat);if(isNaN(n))throw Error("iat field using invalid format");let p=Number(g.exp);if(isNaN(p))throw Error("exp field using invalid format");let s=new Date().getTime()/1e3;if(p>=s+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let t=n-r.CLOCK_SKEW_SECS_,u=p+r.CLOCK_SKEW_SECS_;if(s<t)throw Error("Token used too early, "+s+" < "+t+": "+JSON.stringify(g));if(s>u)throw Error("Token used too late, "+s+" > "+u+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new q.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}c.OAuth2Client=r},48889,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Compute=void 0;let d=a.r(99853),e=a.r(40411),f=a.r(94347);class g extends f.OAuth2Client{serviceAccountEmail;scopes;constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(){let a,b=`service-accounts/${this.serviceAccountEmail}/token`;try{let c={property:b};this.scopes.length>0&&(c.params={scopes:this.scopes.join(",")}),a=await e.instance(c)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let c=a;return a&&a.expires_in&&(c.expiry_date=new Date().getTime()+1e3*a.expires_in,delete c.expires_in),this.emit("tokens",c),{tokens:c,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}c.Compute=g},70241,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdTokenClient=void 0;let d=a.r(94347);class e extends d.OAuth2Client{targetAudience;idTokenProvider;constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}c.IdTokenClient=e},51747,(a,b,c)=>{"use strict";var d,e;let f;Object.defineProperty(c,"__esModule",{value:!0}),c.GCPEnv=void 0,c.clear=function(){f=void 0},c.getEnv=h;let g=a.r(40411);async function h(){return f||(f=i())}async function i(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await k()?await j()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:process.env.CLOUD_RUN_JOB?d.CLOUD_RUN_JOBS:d.COMPUTE_ENGINE:d.NONE}async function j(){try{return await g.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function k(){return g.isAvailable()}(e=d||(c.GCPEnv=d={})).APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",e.NONE="NONE"},60597,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(88947);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}a.r(24361).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},b.exports=f},89815,(a,b,c)=>{"use strict";var d=a.r(874).Buffer,e=a.r(874).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}b.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},79418,(a,b,c)=>{var d,e=a.r(74898).Buffer,f=a.r(54799),g=a.r(8863),h=a.r(24361),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw p(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw p("key must be a string, a buffer or an object")}function n(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function p(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function q(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function r(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw p(i)}}}(c),b=q(b);var d=f.createHmac("sha"+a,c);return n((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var s="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(b,c){return d||(d=a.r(89815)),d(b,c)};function t(a){return function(b,c,d){var f=r(a)(b,d);return s(e.from(c),e.from(f))}}function u(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign(c,"base64")))}}function v(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function w(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function y(a){var b=u(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function z(a){var b=v(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function A(){return function(){return""}}function B(){return function(a,b){return""===b}}b.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:r,rs:u,ps:w,es:y,none:A})[c](d),verify:({hs:t,rs:v,ps:x,es:z,none:B})[c](d)}}},53379,(a,b,c)=>{var d=a.r(874).Buffer;b.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},73546,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(60597),f=a.r(79418),g=a.r(88947),h=a.r(53379),i=a.r(24361);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),n=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),o=m.sign(n,k);return i.format("%s.%s",n,o)}function l(a){var b=a.secret;if(b=null==(b=null==b?a.privateKey:b)?a.key:b,!0===/^hs/i.test(a.header.alg)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=c,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,b.exports=l},45712,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(60597),f=a.r(79418),g=a.r(88947),h=a.r(53379),i=a.r(24361),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function n(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function o(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function p(a){var b=(a=a||{}).secret;if(b=null==(b=null==b?a.publicKey:b)?a.key:b,!0===/^hs/i.test(a.algorithm)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=c,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(p,g),p.prototype.verify=function(){try{var a=n(this.signature.buffer,this.algorithm,this.key.buffer),b=o(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},p.decode=o,p.isValid=m,p.verify=n,b.exports=p},38823,(a,b,c)=>{var d=a.r(73546),e=a.r(45712);c.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],c.sign=d.sign,c.verify=e.verify,c.decode=e.decode,c.isValid=e.isValid,c.createSign=function(a){return new d(a)},c.createVerify=function(a){return new e(a)}},6122,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleToken=void 0;var d,e=j(a.r(22734)),f=a.r(99853),g=j(a.r(38823)),h=j(a.r(14747)),i=a.r(24361);function j(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(j=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=k(a)&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(var h in a)"default"!==h&&({}).hasOwnProperty.call(a,h)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,h))&&(f.get||f.set)?e(g,h,f):g[h]=a[h]);return g})(a,b)}function k(a){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function l(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function m(a,b,c){return a.set(n(a,b),c),c}function n(a,b,c){if("function"==typeof a?a===b:a.has(b))return arguments.length<3?b:c;throw TypeError("Private element is not present on this object")}function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,w(d.key),d)}}function p(a,b,c){return b&&o(a.prototype,b),c&&o(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function q(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function r(a){var b="function"==typeof Map?new Map:void 0;return(r=function(a){if(null===a||!function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}function c(){return function(a,b,c){if(s())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,b);var e=new(a.bind.apply(a,d));return c&&t(e,c.prototype),e}(a,arguments,u(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),t(c,a)})(a)}function s(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(s=function(){return!!a})()}function t(a,b){return(t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function v(a,b,c){return(b=w(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function w(a){var b=function(a,b){if("object"!=k(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=k(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==k(b)?b:b+""}function x(){var a,b,c="function"==typeof Symbol?Symbol:{},d=c.iterator||"@@iterator",e=c.toStringTag||"@@toStringTag";function f(c,d,e,f){var i=Object.create((d&&d.prototype instanceof h?d:h).prototype);return y(i,"_invoke",function(c,d,e){var f,h,i,j=0,k=e||[],l=!1,m={p:0,n:0,v:a,a:n,f:n.bind(a,4),d:function(b,c){return f=b,h=0,i=a,m.n=c,g}};function n(c,d){for(h=c,i=d,b=0;!l&&j&&!e&&b<k.length;b++){var e,f=k[b],n=m.p,o=f[2];c>3?(e=o===d)&&(i=f[(h=f[4])?5:(h=3,3)],f[4]=f[5]=a):f[0]<=n&&((e=c<2&&n<f[1])?(h=0,m.v=d,m.n=f[1]):n<o&&(e=c<3||f[0]>d||d>o)&&(f[4]=c,f[5]=d,m.n=o,h=0))}if(e||c>1)return g;throw l=!0,d}return function(e,k,o){if(j>1)throw TypeError("Generator is already running");for(l&&1===k&&n(k,o),h=k,i=o;(b=h<2?a:i)||!l;){f||(h?h<3?(h>1&&(m.n=-1),n(h,i)):m.n=i:m.v=i);try{if(j=2,f){if(h||(e="next"),b=f[e]){if(!(b=b.call(f,i)))throw TypeError("iterator result is not an object");if(!b.done)return b;i=b.value,h<2&&(h=0)}else 1===h&&(b=f.return)&&b.call(f),h<2&&(i=TypeError("The iterator does not provide a '"+e+"' method"),h=1);f=a}else if((b=(l=m.n<0)?i:c.call(d,m))!==g)break}catch(b){f=a,h=1,i=b}finally{j=1}}return{value:b,done:l}}}(c,e,f),!0),i}var g={};function h(){}function i(){}function j(){}b=Object.getPrototypeOf;var k=j.prototype=h.prototype=Object.create([][d]?b(b([][d]())):(y(b={},d,function(){return this}),b));function l(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,j):(a.__proto__=j,y(a,e,"GeneratorFunction")),a.prototype=Object.create(k),a}return i.prototype=j,y(k,"constructor",j),y(j,"constructor",i),i.displayName="GeneratorFunction",y(j,e,"GeneratorFunction"),y(k),y(k,e,"Generator"),y(k,d,function(){return this}),y(k,"toString",function(){return"[object Generator]"}),(x=function(){return{w:f,m:l}})()}function y(a,b,c,d){var e=Object.defineProperty;try{e({},"",{})}catch(a){e=0}(y=function(a,b,c,d){if(b)e?e(a,b,{value:c,enumerable:!d,configurable:!d,writable:!d}):a[b]=c;else{var f=function(b,c){y(a,b,function(a){return this._invoke(b,c,a)})};f("next",0),f("throw",1),f("return",2)}})(a,b,c,d)}function z(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function A(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){z(f,d,e,g,h,"next",a)}function h(a){z(f,d,e,g,h,"throw",a)}g(void 0)})}}var B=e.readFile?(0,i.promisify)(e.readFile):A(x().m(function a(){return x().w(function(a){for(;;)switch(a.n){case 0:throw new D("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return a.a(2)}},a)})),C="https://oauth2.googleapis.com/token",D=function(a){function b(a,c){var d,e,f;return q(this,b),e=b,f=[a],e=u(e),v(d=function(a,b){if(b&&("object"==k(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,s()?Reflect.construct(e,f||[],u(this).constructor):e.apply(this,f)),"code",void 0),d.code=c,d}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),a&&t(b,a),p(b)}(r(Error)),E=new WeakMap,F=new WeakSet;function G(a){return H.apply(this,arguments)}function H(){return(H=A(x().m(function a(b){return x().w(function(a){for(;;)switch(a.n){case 0:if(!E.get(n(E,this))||b.forceRefresh){a.n=1;break}return a.a(2,E.get(n(E,this)));case 1:return a.p=1,a.n=2,m(E,this,n(F,this,I).call(this,b));case 2:return a.a(2,a.v);case 3:return a.p=3,m(E,this,void 0),a.f(3);case 4:return a.a(2)}},a,this,[[1,,3,4]])}))).apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){return(J=A(x().m(function a(b){var c;return x().w(function(a){for(;;)switch(a.n){case 0:if(!1!==this.isTokenExpiring()||!1!==b.forceRefresh){a.n=1;break}return a.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){a.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){a.n=4;break}return a.n=3,this.getCredentials(this.keyFile);case 3:c=a.v,this.key=c.privateKey,this.iss=c.clientEmail||this.iss,c.clientEmail||n(F,this,K).call(this);case 4:return a.a(2,n(F,this,O).call(this))}},a,this)}))).apply(this,arguments)}function K(){if(!this.iss)throw new D("email is required.","MISSING_CREDENTIALS")}function L(){return M.apply(this,arguments)}function M(){return(M=A(x().m(function a(){var b;return x().w(function(a){for(;;)switch(a.n){case 0:if(this.accessToken){a.n=1;break}throw Error("No token to revoke.");case 1:return b="https://oauth2.googleapis.com/revoke?token="+this.accessToken,a.n=2,this.transporter.request({url:b,retry:!0});case 2:n(F,this,N).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return a.a(2)}},a,this)}))).apply(this,arguments)}function N(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"===k(a.scope)?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)}function O(){return P.apply(this,arguments)}function P(){return(P=A(x().m(function a(){var b,c,d,e,f,h,i,j,k,l;return x().w(function(a){for(;;)switch(a.n){case 0:return b=Math.floor(new Date().getTime()/1e3),c=this.additionalClaims||{},d=Object.assign({iss:this.iss,scope:this.scope,aud:C,exp:b+3600,iat:b,sub:this.sub},c),e=g.sign({header:{alg:"RS256"},payload:d,secret:this.key}),a.p=1,a.n=2,this.transporter.request({method:"POST",url:C,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return f=a.v,this.rawToken=f.data,this.expiresAt=null===f.data.expires_in||void 0===f.data.expires_in?void 0:(b+f.data.expires_in)*1e3,a.a(2,this.rawToken);case 3:throw a.p=3,l=a.v,this.rawToken=void 0,this.tokenExpires=void 0,(j=l.response&&null!=(h=l.response)&&h.data?null==(i=l.response)?void 0:i.data:{}).error&&(k=j.error_description?": ".concat(j.error_description):"",l.message="".concat(j.error).concat(k)),l;case 4:return a.a(2)}},a,this,[[1,3]])}))).apply(this,arguments)}c.GoogleToken=p(function a(b){q(this,a),l(this,F),F.add(this),v(this,"expiresAt",void 0),v(this,"key",void 0),v(this,"keyFile",void 0),v(this,"iss",void 0),v(this,"sub",void 0),v(this,"scope",void 0),v(this,"rawToken",void 0),v(this,"tokenExpires",void 0),v(this,"email",void 0),v(this,"additionalClaims",void 0),v(this,"eagerRefreshThresholdMillis",void 0),v(this,"transporter",{request:function(a){return(0,f.request)(a)}}),l(this,E),E.set(this,void 0),n(F,this,N).call(this,b)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var a,b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}},{key:"getToken",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===k(a)&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){var c=a;n(F,this,G).call(this,b).then(function(a){return c(null,a)},a);return}return n(F,this,G).call(this,b)}},{key:"getCredentials",value:(d=A(x().m(function a(b){var c,d,e,f,g;return x().w(function(a){for(;;)switch(a.n){case 0:a.n=".json"===(g=h.extname(b))?1:".der"===g||".crt"===g||".pem"===g?4:".p12"===g||".pfx"===g?6:7;break;case 1:return a.n=2,B(b,"utf8");case 2:if(d=(c=JSON.parse(a.v)).private_key,e=c.client_email,!(!d||!e)){a.n=3;break}throw new D("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return a.a(2,{privateKey:d,clientEmail:e});case 4:return a.n=5,B(b,"utf8");case 5:return f=a.v,a.a(2,{privateKey:f});case 6:throw new D("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new D("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return a.a(2)}},a)})),function(a){return d.apply(this,arguments)})},{key:"revokeToken",value:function(a){return a?void n(F,this,L).call(this).then(function(){return a()},a):n(F,this,L).call(this)}}])},88329,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWTAccess=void 0;let d=a.r(38823),e=a.r(98126),f={alg:"RS256",typ:"JWT"};class g{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new e.LRUCache({capacity:500,maxAge:36e5});constructor(a,b,c,d){this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=d??3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return new Headers(i.headers);let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,n=Object.assign(e,b),o=d.sign({header:m,payload:n,secret:this.key}),p=new Headers({authorization:`Bearer ${o}`});return this.cache.set(h,{expiration:1e3*l,headers:p}),p}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}c.JWTAccess=g},42911,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWT=void 0;let d=a.r(6122),e=a.r(88329),f=a.r(94347),g=a.r(30190);class h extends f.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(a={}){super(a),this.email=a.email,this.keyFile=a.keyFile,this.key=a.key,this.keyId=a.keyId,this.scopes=a.scopes,this.subject=a.subject,this.additionalClaims=a.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${a.id_token}`}))}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(a??void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:new Headers}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(){let a=this.createGToken(),b={access_token:(await a.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:a.expiresAt,id_token:a.idToken};return this.emit("tokens",b),{res:null,tokens:b}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}c.JWT=h},92114,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UserRefreshClient=c.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=a.r(94347),e=a.r(30190);c.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{_refreshToken;constructor(a,b,c,d,e){const f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){let b={...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})};return e.AuthClient.setMethodName(b,"fetchIdToken"),(await this.transporter.request(b)).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}c.UserRefreshClient=f},61576,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Impersonated=c.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=a.r(94347),e=a.r(99853),f=a.r(98126);c.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(a={}){if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=a.sourceClient??new d.OAuth2Client,this.targetPrincipal=a.targetPrincipal??"",this.delegates=a.delegates??[],this.targetScopes=a.targetScopes??[],this.lifetime=a.lifetime??3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=a.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(c){if(!(c instanceof Error))throw c;let a=0,b="";if(c instanceof e.GaxiosError&&(a=c?.response?.data?.error?.status,b=c?.response?.data?.error?.message),a&&b)throw c.message=`${a}: unable to impersonate: ${b}`,c;throw c.message=`unable to impersonate: ${c}`,c}}async fetchIdToken(a,b){await this.sourceClient.getAccessToken();let c=`projects/-/serviceAccounts/${this.targetPrincipal}`,d=`${this.endpoint}/v1/${c}:generateIdToken`,e={delegates:this.delegates,audience:a,includeEmail:b?.includeEmail??!0,useEmailAzp:b?.includeEmail??!0};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:d,data:e,method:"POST"})).data.token}}c.Impersonated=g},21575,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.OAuthClientAuthHandler=void 0,c.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=a.r(99853),e=a.r(65726),f=["PUT","POST","PATCH"];class g{#m=(0,e.createCrypto)();#n;transporter;constructor(a){a&&"clientId"in a?(this.#n=a,this.transporter=new d.Gaxios):(this.#n=a?.clientAuthentication,this.transporter=a?.transporter||new d.Gaxios)}applyClientAuthenticationOptions(a,b){a.headers=d.Gaxios.mergeHeaders(a.headers),this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){if(b)a.headers=d.Gaxios.mergeHeaders(a.headers,{authorization:`Bearer ${b}`});else if(this.#n?.confidentialClientType==="basic"){a.headers=d.Gaxios.mergeHeaders(a.headers);let b=this.#n.clientId,c=this.#n.clientSecret||"",e=this.#m.encodeBase64StringUtf8(`${b}:${c}`);d.Gaxios.mergeHeaders(a.headers,{authorization:`Basic ${e}`})}}injectAuthenticatedRequestBody(a){if(this.#n?.confidentialClientType==="request-body"){let b=(a.method||"GET").toUpperCase();if(!f.includes(b))throw Error(`${b} HTTP method does not support ${this.#n.confidentialClientType} client authentication`);let c=new Headers(a.headers).get("content-type");if(c?.startsWith("application/x-www-form-urlencoded")||a.data instanceof URLSearchParams){let b=new URLSearchParams(a.data??"");b.append("client_id",this.#n.clientId),b.append("client_secret",this.#n.clientSecret||""),a.data=b}else if(c?.startsWith("application/json"))a.data=a.data||{},Object.assign(a.data,{client_id:this.#n.clientId,client_secret:this.#n.clientSecret||""});else throw Error(`${c} content-types are not supported with ${this.#n.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.OAuthClientAuthHandler=g},78794,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StsCredentials=void 0;let d=a.r(99853),e=a.r(30190),f=a.r(21575),g=a.r(98126);class h extends f.OAuthClientAuthHandler{#o;constructor(a={tokenExchangeEndpoint:""},b){("object"!=typeof a||a instanceof URL)&&(a={tokenExchangeEndpoint:a,clientAuthentication:b}),super(a),this.#o=a.tokenExchangeEndpoint}async exchangeToken(a,b,c){let i={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:a.scope?.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:a.actingParty?.actorToken,actor_token_type:a.actingParty?.actorTokenType,options:c&&JSON.stringify(c)},j={...h.RETRY_CONFIG,url:this.#o.toString(),method:"POST",headers:b,data:new URLSearchParams((0,g.removeUndefinedValuesInObject)(i))};e.AuthClient.setMethodName(j,"exchangeToken"),this.applyClientAuthenticationOptions(j);try{let a=await this.transporter.request(j),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,f.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}c.StsCredentials=h},20382,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BaseExternalAccountClient=c.CLOUD_RESOURCE_MANAGER=c.EXTERNAL_ACCOUNT_TYPE=c.EXPIRATION_TIME_OFFSET=void 0;let d=a.r(99853),e=a.r(88947),f=a.r(30190),g=a.r(78794),h=a.r(98126),i=a.r(15204),j="https://www.googleapis.com/auth/cloud-platform";c.EXPIRATION_TIME_OFFSET=3e5,c.EXTERNAL_ACCOUNT_TYPE="external_account",c.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class k extends f.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#p=null;constructor(a){super(a);const b=(0,h.originalOrCamelOptions)(a),d=b.get("type");if(d&&d!==c.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${c.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);const e=b.get("client_id"),f=b.get("client_secret");this.tokenUrl=b.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);const i=b.get("subject_token_type"),k=b.get("workforce_pool_user_project"),l=b.get("service_account_impersonation_url"),m=b.get("service_account_impersonation"),n=(0,h.originalOrCamelOptions)(m).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(b.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),e&&(this.clientAuth={confidentialClientType:"basic",clientId:e,clientSecret:f}),this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=b.get("scopes")||[j],this.cachedAccessToken=null,this.audience=b.get("audience"),this.subjectTokenType=i,this.workforcePoolUserProject=k;const o=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(o))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=l,this.serviceAccountImpersonationLifetime=n,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let a=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return a?.groups?.email||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c={...k.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`};f.AuthClient.setMethodName(c,"getProjectId");let d=await this.transporter.request(c);return this.projectId=d.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){this.#p=this.#p||this.#q();try{return await this.#p}finally{this.#p=null}}async #q(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[j]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...k.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};f.AuthClient.setMethodName(b,"getImpersonatedAccessToken");let c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[j]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${i.pkg.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}c.BaseExternalAccountClient=k},80689,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FileSubjectTokenSupplier=void 0;let d=a.r(24361),e=a.r(22734),f=(0,d.promisify)(e.readFile??(()=>{})),g=(0,d.promisify)(e.realpath??(()=>{})),h=(0,d.promisify)(e.lstat??(()=>{}));c.FileSubjectTokenSupplier=class{filePath;formatType;subjectTokenFieldName;constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(){let a,b=this.filePath;try{if(b=await g(b),!(await h(b)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${b} does not exist, or it is not a file. ${a.message}`),a}let c=await f(b,{encoding:"utf8"});if("text"===this.formatType?a=c:"json"===this.formatType&&this.subjectTokenFieldName&&(a=JSON.parse(c)[this.subjectTokenFieldName]),!a)throw Error("Unable to parse the subject_token from the credential_source file");return a}}},58405,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UrlSubjectTokenSupplier=void 0;let d=a.r(30190);c.UrlSubjectTokenSupplier=class{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(d.AuthClient.setMethodName(c,"getSubjectToken"),"text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}},61890,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CertificateSubjectTokenSupplier=c.InvalidConfigurationError=c.CertificateSourceUnavailableError=c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let d=a.r(98126),e=a.r(22734),f=a.r(54799),g=a.r(24836);c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class h extends Error{constructor(a){super(a),this.name="CertificateSourceUnavailableError"}}c.CertificateSourceUnavailableError=h;class i extends Error{constructor(a){super(a),this.name="InvalidConfigurationError"}}c.InvalidConfigurationError=i,c.CertificateSubjectTokenSupplier=class{certificateConfigPath;trustChainPath;cert;key;constructor(a){if(!a.useDefaultCertificateConfig&&!a.certificateConfigLocation)throw new i("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(a.useDefaultCertificateConfig&&a.certificateConfigLocation)throw new i("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=a.trustChainPath,this.certificateConfigPath=a.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new i("Cannot create mTLS Agent with missing certificate or key");return new g.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#r();let{certPath:a,keyPath:b}=await this.#s();return{cert:this.cert,key:this.key}=await this.#t(a,b),await this.#u(this.cert)}async #r(){let a=this.certificateConfigPath;if(a){if(await (0,d.isValidFile)(a))return a;throw new h(`Provided certificate config path is invalid: ${a}`)}let b=process.env[c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(b){if(await (0,d.isValidFile)(b))return b;throw new h(`Path from environment variable "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${b}`)}let e=(0,d.getWellKnownCertificateConfigFileLocation)();if(await (0,d.isValidFile)(e))return e;throw new h(`Could not find certificate configuration file. Searched override path, the "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${e}).`)}async #s(){let a,b=this.certificateConfigPath;try{a=await e.promises.readFile(b,"utf8")}catch(a){throw new h(`Failed to read certificate config file at: ${b}`)}try{let c=JSON.parse(a),d=c?.cert_configs?.workload?.cert_path,e=c?.cert_configs?.workload?.key_path;if(!d||!e)throw new i(`Certificate config file (${b}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:d,keyPath:e}}catch(a){if(a instanceof i)throw a;throw new i(`Failed to parse certificate config from ${b}: ${a.message}`)}}async #t(a,b){let c,d;try{c=await e.promises.readFile(a),new f.X509Certificate(c)}catch(c){let b=c instanceof Error?c.message:String(c);throw new h(`Failed to read certificate file at ${a}: ${b}`)}try{d=await e.promises.readFile(b),(0,f.createPrivateKey)(d)}catch(c){let a=c instanceof Error?c.message:String(c);throw new h(`Failed to read private key file at ${b}: ${a}`)}return{cert:c,key:d}}async #u(a){let b=new f.X509Certificate(a);if(!this.trustChainPath)return JSON.stringify([b.raw.toString("base64")]);try{let a,c=((await e.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((a,b)=>{try{return new f.X509Certificate(a)}catch(c){let a=c instanceof Error?c.message:String(c);throw new i(`Failed to parse certificate at index ${b} in trust chain file ${this.trustChainPath}: ${a}`)}}),d=c.findIndex(a=>b.raw.equals(a.raw));if(-1===d)a=[b,...c];else if(0===d)a=c;else throw new i(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${d}).`);return JSON.stringify(a.map(a=>a.raw.toString("base64")))}catch(b){if(b instanceof i)throw b;let a=b instanceof Error?b.message:String(b);throw new h(`Failed to process certificate chain from ${this.trustChainPath}: ${a}`)}}}},32386,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdentityPoolClient=void 0;let d=a.r(20382),e=a.r(98126),f=a.r(80689),g=a.r(58405),h=a.r(61890),i=a.r(78794),j=a.r(99853);class k extends d.BaseExternalAccountClient{subjectTokenSupplier;constructor(a){super(a);const b=(0,e.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("subject_token_supplier");if(!c&&!d)throw Error("A credential source or subject token supplier must be specified.");if(c&&d)throw Error("Only one of credential source or subject token supplier can be specified.");if(d)this.subjectTokenSupplier=d,this.credentialSourceType="programmatic";else{const a=(0,e.originalOrCamelOptions)(c),b=(0,e.originalOrCamelOptions)(a.get("format")),d=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==d&&"text"!==d)throw Error(`Invalid credential_source format "${d}"`);if("json"===d&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");const j=a.get("file"),l=a.get("url"),m=a.get("certificate"),n=a.get("headers");if(j&&l||l&&m||j&&m)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(j)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:d,subjectTokenFieldName:i});else if(l)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:l,formatType:d,subjectTokenFieldName:i,headers:n,additionalGaxiosOptions:k.RETRY_CONFIG});else if(m){this.credentialSourceType="certificate";const a=new h.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:m.use_default_certificate_config,certificateConfigLocation:m.certificate_config_location,trustChainPath:m.trust_chain_path});this.subjectTokenSupplier=a}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let a=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof h.CertificateSubjectTokenSupplier){let a=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new i.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new j.Gaxios({agent:a})}),this.transporter=new j.Gaxios({...this.transporter.defaults||{},agent:a})}return a}}c.IdentityPoolClient=k},59660,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsRequestSigner=void 0;let d=a.r(99853),e=a.r(65726),f="AWS4-HMAC-SHA256";async function g(a,b,c){return await a.signWithHmacSha256(b,c)}async function h(a,b,c,d,e){let f=await g(a,`AWS4${b}`,c),h=await g(a,f,d),i=await g(a,h,e);return await g(a,i,"aws4_request")}async function i(a){let b=d.Gaxios.mergeHeaders(a.additionalAmzHeaders),c=a.requestPayload||"",i=a.host.split(".")[0],j=new Date,k=j.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),l=j.toISOString().replace(/[-]/g,"").replace(/T.*/,"");a.securityCredentials.token&&b.set("x-amz-security-token",a.securityCredentials.token);let m=d.Gaxios.mergeHeaders({host:a.host},b.has("date")?{}:{"x-amz-date":k},b),n="",o=[...m.keys()].sort();o.forEach(a=>{n+=`${a}:${m.get(a)}
`});let p=o.join(";"),q=await a.crypto.sha256DigestHex(c),r=`${a.method.toUpperCase()}
${a.canonicalUri}
${a.canonicalQuerystring}
${n}
${p}
${q}`,s=`${l}/${a.region}/${i}/aws4_request`,t=`${f}
${k}
${s}
`+await a.crypto.sha256DigestHex(r),u=await h(a.crypto,a.securityCredentials.secretAccessKey,l,a.region,i),v=await g(a.crypto,u,t),w=`${f} Credential=${a.securityCredentials.accessKeyId}/${s}, SignedHeaders=${p}, Signature=${(0,e.fromArrayBufferToHex)(v)}`;return{amzDate:b.has("date")?void 0:k,authorizationHeader:w,canonicalQuerystring:a.canonicalQuerystring}}c.AwsRequestSigner=class{getCredentials;region;crypto;constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,e.createCrypto)()}async getRequestOptions(a){if(!a.url)throw RangeError('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,e=a.method||"GET",f=a.body||b,g=a.headers,h=await this.getCredentials(),j=new URL(c);if("string"!=typeof f&&void 0!==f)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${f}`);let k=await i({crypto:this.crypto,host:j.host,canonicalUri:j.pathname,canonicalQuerystring:j.search.slice(1),method:e,region:this.region,securityCredentials:h,requestPayload:f,additionalAmzHeaders:g}),l=d.Gaxios.mergeHeaders(k.amzDate?{"x-amz-date":k.amzDate}:{},{authorization:k.authorizationHeader,host:j.host},g||{});h.token&&d.Gaxios.mergeHeaders(l,{"x-amz-security-token":h.token});let m={url:c,method:e,headers:l};return void 0!==f&&(m.body=f),m}}},29723,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultAwsSecurityCredentialsSupplier=void 0;let d=a.r(30190);c.DefaultAwsSecurityCredentialsSupplier=class{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(a){this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(this.#v)return this.#v;let b=new Headers;if(!this.#v&&this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#w(a.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:b};d.AuthClient.setMethodName(c,"getAwsRegion");let e=await a.transporter.request(c);return e.data.substr(0,e.data.length-1)}async getAwsSecurityCredentials(a){if(this.#x)return this.#x;let b=new Headers;this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#w(a.transporter));let c=await this.#y(b,a.transporter),d=await this.#z(c,b,a.transporter);return{accessKeyId:d.AccessKeyId,secretAccessKey:d.SecretAccessKey,token:d.Token}}async #w(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return d.AuthClient.setMethodName(b,"#getImdsV2SessionToken"),(await a.request(b)).data}async #y(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:a};return d.AuthClient.setMethodName(c,"#getAwsRoleName"),(await b.request(c)).data}async #z(a,b,c){let e={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,headers:b};return d.AuthClient.setMethodName(e,"#retrieveAwsSecurityCredentials"),(await c.request(e)).data}get #v(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #x(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}},77961,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsClient=void 0;let d=a.r(59660),e=a.r(20382),f=a.r(29723),g=a.r(98126),h=a.r(99853);class i extends e.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #A="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(a){super(a);const b=(0,g.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("aws_security_credentials_supplier");if(!c&&!d)throw Error("A credential source or AWS security credentials supplier must be specified.");if(c&&d)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(d)this.awsSecurityCredentialsSupplier=d,this.regionalCredVerificationUrl=i.#A,this.credentialSourceType="programmatic";else{const a=(0,g.originalOrCamelOptions)(c);this.environmentId=a.get("environment_id");const b=a.get("region_url"),d=a.get("url"),e=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new f.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:d,imdsV2SessionTokenUrl:e}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let a=this.environmentId?.match(/^(aws)(\d+)$/);if(a&&this.regionalCredVerificationUrl){if(1!==parseInt(a[2],10))throw Error(`aws version "${a[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new d.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...i.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[];return h.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},a.headers).forEach((a,c)=>b.push({key:c,value:a})),encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}c.AwsClient=i},71544,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InvalidSubjectTokenError=c.InvalidMessageFieldError=c.InvalidCodeFieldError=c.InvalidTokenTypeFieldError=c.InvalidExpirationTimeFieldError=c.InvalidSuccessFieldError=c.InvalidVersionFieldError=c.ExecutableResponseError=c.ExecutableResponse=void 0;let d="urn:ietf:params:oauth:token-type:saml2",e="urn:ietf:params:oauth:token-type:id_token",f="urn:ietf:params:oauth:token-type:jwt";c.ExecutableResponse=class{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==d&&this.tokenType!==e&&this.tokenType!==f)throw new j(`Executable response must contain a 'token_type' field when successful and it must be one of ${e}, ${f}, or ${d}.`);if(this.tokenType===d){if(!a.saml_response)throw new m(`Executable response must contain a 'saml_response' field when token_type=${d}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new m(`Executable response must contain a 'id_token' field when token_type=${e} or ${f}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new k("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new l("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableResponseError=g;class h extends g{}c.InvalidVersionFieldError=h;class i extends g{}c.InvalidSuccessFieldError=i,c.InvalidExpirationTimeFieldError=class extends g{};class j extends g{}c.InvalidTokenTypeFieldError=j;class k extends g{}c.InvalidCodeFieldError=k;class l extends g{}c.InvalidMessageFieldError=l;class m extends g{}c.InvalidSubjectTokenError=m},20361,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthHandler=c.ExecutableError=void 0;let d=a.r(71544),e=a.r(33405),f=a.r(22734);class g extends Error{code;constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableError=g;class h{commandComponents;timeoutMillis;outputFile;constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let f=e.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";f.stdout.on("data",a=>{h+=a}),f.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(f.removeAllListeners(),f.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",a=>{if(clearTimeout(i),0!==a)return c(new g(h,a.toString()));try{let a=JSON.parse(h),c=new d.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof d.ExecutableResponseError)return c(a);return c(new d.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await f.promises.realpath(this.outputFile)}catch{return}if(!(await f.promises.lstat(a)).isFile())return;let b=await f.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new d.ExecutableResponse(a).isValid())return new d.ExecutableResponse(a);return}catch(a){if(a instanceof d.ExecutableResponseError)throw a;throw new d.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}c.PluggableAuthHandler=h},18451,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthClient=c.ExecutableError=void 0;let d=a.r(20382),e=a.r(71544),f=a.r(20361);var g=a.r(20361);Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return g.ExecutableError}});class h extends d.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(a){if(super(a),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new f.ExecutableError(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}c.PluggableAuthClient=h},50489,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountClient=void 0;let d=a.r(20382),e=a.r(32386),f=a.r(77961),g=a.r(18451);c.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a){return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?a.credential_source?.environment_id?new f.AwsClient(a):a.credential_source?.executable?new g.PluggableAuthClient(a):new e.IdentityPoolClient(a):null}}},44737,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=a.r(30190),e=a.r(21575),f=a.r(99853),g=a.r(88947),h=a.r(20382);c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{#B;constructor(a){super(a),this.#B=a.tokenRefreshEndpoint}async refreshToken(a,b){let c={...i.RETRY_CONFIG,url:this.#B,method:"POST",headers:b,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:a})};d.AuthClient.setMethodName(c,"refreshToken"),this.applyClientAuthenticationOptions(c);try{let a=await this.transporter.request(c),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(a){super(a),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;const b={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i({tokenRefreshEndpoint:a.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:b}),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof a?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!a?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=f.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.ExternalAccountAuthorizedUserClient=j},35058,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.GoogleAuthExceptionMessages=void 0;let d=a.r(33405),e=a.r(22734),f=a.r(99853),g=a.r(40411),h=a.r(46786),i=a.r(14747),j=a.r(65726),k=a.r(48889),l=a.r(70241),m=a.r(51747),n=a.r(42911),o=a.r(92114),p=a.r(61576),q=a.r(50489),r=a.r(20382),s=a.r(30190),t=a.r(44737),u=a.r(98126);c.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"},c.GoogleAuth=class{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#C=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(a={}){if(this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(c.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if(a||=await this.getProductionProjectId(),a||=await this.getFileProjectId(),a||=await this.getDefaultServiceProjectId(),a||=await this.getGCEProjectId(),a||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=a,a;throw Error(c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let a;try{a=await g.universe("universe-domain"),a||=s.DEFAULT_UNIVERSE}catch(b){if(b&&b?.response?.status===404)a=s.DEFAULT_UNIVERSE;else throw b}return a}async getUniverseDomain(){let a=(0,u.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{a??=(await this.getClient()).universeDomain}catch{a??=s.DEFAULT_UNIVERSE}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let b;if(this.cachedCredential)return await this.#D(this.cachedCredential,null);if((b=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(b=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return b instanceof n.JWT?b.scopes=this.scopes:b instanceof r.BaseExternalAccountClient&&(b.scopes=this.getAnyScopes()),await this.#D(b);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await this.#D(new k.Compute(a));throw Error(c.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #D(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=g.getGCPResidency()||await g.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=i.join(a,".config"))}return(b&&(b=i.join(b,"gcloud","application_default_credentials.json"),e.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=e.realpathSync(a),!e.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=e.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==p.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${p.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let b=this.fromJSON(a.source_credentials);if(a.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url)?.groups?.target;if(!c)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let d=(this.scopes||a.scopes||this.defaultScopes)??[];return new p.Impersonated({...a,sourceClient:b,targetPrincipal:c,targetScopes:Array.isArray(d)?d:[d]})}fromJSON(a,b={}){let c,d=(0,u.originalOrCamelOptions)(b).get("universe_domain");return a.type===o.USER_REFRESH_ACCOUNT_TYPE?(c=new o.UserRefreshClient(b)).fromJSON(a):a.type===p.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===r.EXTERNAL_ACCOUNT_TYPE?(c=q.ExternalAccountClient.fromJSON({...a,...b})).scopes=this.getAnyScopes():a.type===t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new t.ExternalAccountAuthorizedUserClient({...a,...b}):(b.scopes=this.scopes,c=new n.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new n.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new n.JWT({...b,apiKey:a})}_isWindows(){let a=h.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,d.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==r.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await g.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof p.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof r.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([g.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(c.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#C=this.#C||this.#E();try{return await this.#C}finally{this.#C=null}}async #E(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=i.resolve(this.keyFilename),b=e.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await this.#D(a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new l.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a={}){let b=a.url,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=f.Gaxios.mergeHeaders(a.headers,d),a}async fetch(...a){return(await this.getClient()).fetch(...a)}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,m.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof p.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,j.createCrypto)();if(c instanceof n.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}},79746,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IAMAuth=void 0,c.IAMAuth=class{selector;token;constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},43581,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DownscopedClient=c.EXPIRATION_TIME_OFFSET=c.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=a.r(99853),e=a.r(88947),f=a.r(30190),g=a.r(78794);c.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,c.EXPIRATION_TIME_OFFSET=3e5;class h extends f.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(a,b={accessBoundary:{accessBoundaryRules:[]}}){if(super(a instanceof f.AuthClient?{}:a),a instanceof f.AuthClient?(this.authClient=a,this.credentialAccessBoundary=b):(this.authClient=a.authClient,this.credentialAccessBoundary=a.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>c.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${c.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const a of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=(await this.authClient.getAccessToken()).token,b=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),c=this.authClient.credentials?.expiry_date||null,d=b.expires_in?new Date().getTime()+1e3*b.expires_in:c;return this.cachedDownscopedAccessToken={access_token:b.access_token,expiry_date:d,res:b.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.DownscopedClient=h},46183,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PassThroughClient=void 0;let d=a.r(30190);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}c.PassThroughClient=e},28684,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.auth=c.PassThroughClient=c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=c.ExecutableError=c.PluggableAuthClient=c.DownscopedClient=c.BaseExternalAccountClient=c.ExternalAccountClient=c.IdentityPoolClient=c.AwsRequestSigner=c.AwsClient=c.UserRefreshClient=c.LoginTicket=c.ClientAuthentication=c.OAuth2Client=c.CodeChallengeMethod=c.Impersonated=c.JWT=c.JWTAccess=c.IdTokenClient=c.IAMAuth=c.GCPEnv=c.Compute=c.DEFAULT_UNIVERSE=c.AuthClient=c.gaxios=c.gcpMetadata=void 0;let d=a.r(35058);Object.defineProperty(c,"GoogleAuth",{enumerable:!0,get:function(){return d.GoogleAuth}}),c.gcpMetadata=a.r(40411),c.gaxios=a.r(99853);var e=a.r(30190);Object.defineProperty(c,"AuthClient",{enumerable:!0,get:function(){return e.AuthClient}}),Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return e.DEFAULT_UNIVERSE}});var f=a.r(48889);Object.defineProperty(c,"Compute",{enumerable:!0,get:function(){return f.Compute}});var g=a.r(51747);Object.defineProperty(c,"GCPEnv",{enumerable:!0,get:function(){return g.GCPEnv}});var h=a.r(79746);Object.defineProperty(c,"IAMAuth",{enumerable:!0,get:function(){return h.IAMAuth}});var i=a.r(70241);Object.defineProperty(c,"IdTokenClient",{enumerable:!0,get:function(){return i.IdTokenClient}});var j=a.r(88329);Object.defineProperty(c,"JWTAccess",{enumerable:!0,get:function(){return j.JWTAccess}});var k=a.r(42911);Object.defineProperty(c,"JWT",{enumerable:!0,get:function(){return k.JWT}});var l=a.r(61576);Object.defineProperty(c,"Impersonated",{enumerable:!0,get:function(){return l.Impersonated}});var m=a.r(94347);Object.defineProperty(c,"CodeChallengeMethod",{enumerable:!0,get:function(){return m.CodeChallengeMethod}}),Object.defineProperty(c,"OAuth2Client",{enumerable:!0,get:function(){return m.OAuth2Client}}),Object.defineProperty(c,"ClientAuthentication",{enumerable:!0,get:function(){return m.ClientAuthentication}});var n=a.r(98463);Object.defineProperty(c,"LoginTicket",{enumerable:!0,get:function(){return n.LoginTicket}});var o=a.r(92114);Object.defineProperty(c,"UserRefreshClient",{enumerable:!0,get:function(){return o.UserRefreshClient}});var p=a.r(77961);Object.defineProperty(c,"AwsClient",{enumerable:!0,get:function(){return p.AwsClient}});var q=a.r(59660);Object.defineProperty(c,"AwsRequestSigner",{enumerable:!0,get:function(){return q.AwsRequestSigner}});var r=a.r(32386);Object.defineProperty(c,"IdentityPoolClient",{enumerable:!0,get:function(){return r.IdentityPoolClient}});var s=a.r(50489);Object.defineProperty(c,"ExternalAccountClient",{enumerable:!0,get:function(){return s.ExternalAccountClient}});var t=a.r(20382);Object.defineProperty(c,"BaseExternalAccountClient",{enumerable:!0,get:function(){return t.BaseExternalAccountClient}});var u=a.r(43581);Object.defineProperty(c,"DownscopedClient",{enumerable:!0,get:function(){return u.DownscopedClient}});var v=a.r(18451);Object.defineProperty(c,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}}),Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return v.ExecutableError}});var w=a.r(44737);Object.defineProperty(c,"EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE",{enumerable:!0,get:function(){return w.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE}}),Object.defineProperty(c,"ExternalAccountAuthorizedUserClient",{enumerable:!0,get:function(){return w.ExternalAccountAuthorizedUserClient}});var x=a.r(46183);Object.defineProperty(c,"PassThroughClient",{enumerable:!0,get:function(){return x.PassThroughClient}}),c.auth=new d.GoogleAuth},24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},88646,(a,b,c)=>{b.exports=a.x("node:stream/promises",()=>require("node:stream/promises"))},6461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},65514,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,CLOSE_TIMEOUT:3e4,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},40352,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(65514),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},29110,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},19199,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(40352),g=a.r(29110),{kStatusCode:h}=a.r(65514),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},55572,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(65514);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},75091,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(19199),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(65514),{concat:j,toArrayBuffer:k,unmask:l}=a.r(40352),{isValidStatusCode:m,isValidUTF8:n}=a.r(55572),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},10697,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(19199),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(65514),{isBlob:k,isValidStatusCode:l}=a.r(55572),{mask:m,toBuffer:n}=a.r(40352),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},4049,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(65514),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},20529,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},89877,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(19199),o=a.r(75091),p=a.r(10697),{isBlob:q}=a.r(55572),{BINARY_TYPES:r,CLOSE_TIMEOUT:s,EMPTY_BUFFER:t,GUID:u,kForOnEventAttribute:v,kListener:w,kStatusCode:x,kWebSocket:y,NOOP:z}=a.r(65514),{EventTarget:{addEventListener:A,removeEventListener:B}}=a.r(4049),{format:C,parse:D}=a.r(20529),{toBuffer:E}=a.r(40352),F=Symbol("kAborted"),G=[8,13],H=["CONNECTING","OPEN","CLOSING","CLOSED"],I=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class J extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=t,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=J.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,closeTimeout:s,protocolVersion:G[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,b._closeTimeout=p.closeTimeout,!G.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${G.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void K(b,a);throw a}let t=q?443:80,v=i(16).toString("base64"),w=q?e.request:f.request,x=new Set;if(p.createConnection=p.createConnection||(q?M:L),p.defaultPort=p.defaultPort||t,p.port=h.port||t,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=C({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!I.test(a)||x.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=w(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=w(p);p.timeout&&o.on("timeout",()=>{N(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[F]||(o=b._req=null,K(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void N(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){K(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||N(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==J.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void N(b,c,"Invalid Upgrade header");let g=j("sha1").update(v+u).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void N(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?x.size?x.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":x.size&&(e="Server sent no subprotocol"),e)return void N(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void N(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=D(i)}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void N(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._closeTimeout=c.closeTimeout,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[y]=this,e[y]=this,a[y]=this,d.on("conclude",P),d.on("drain",Q),d.on("error",R),d.on("message",T),d.on("ping",U),d.on("pong",V),e.onerror=X,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Z),a.on("data",$),a.on("end",_),a.on("error",aa),this._readyState=J.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===J.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=J.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),Y(this)}}pause(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)?O(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||t,b,c))}pong(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)?O(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||t,b,c))}resume(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)return void O(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||t,d,c)}terminate(){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=J.CLOSING,this._socket.destroy())}}}function K(a,b){a._readyState=J.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function L(a){return a.path=a.socketPath,g.connect(a)}function M(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function N(a,b,c){a._readyState=J.CLOSING;let d=Error(c);Error.captureStackTrace(d,N),b.setHeader?(b[F]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(K,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function O(a,b,c){if(b){let c=q(b)?b.size:E(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${H[a.readyState]})`);process.nextTick(c,b)}}function P(a,b){let c=this[y];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[y]&&(c._socket.removeListener("data",$),process.nextTick(W,c._socket),1005===a?c.close():c.close(a,b))}function Q(){let a=this[y];a.isPaused||a._socket.resume()}function R(a){let b=this[y];void 0!==b._socket[y]&&(b._socket.removeListener("data",$),process.nextTick(W,b._socket),b.close(a[x])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function S(){this[y].emitClose()}function T(a,b){this[y].emit("message",a,b)}function U(a){let b=this[y];b._autoPong&&b.pong(a,!this._isServer,z),b.emit("ping",a)}function V(a){this[y].emit("pong",a)}function W(a){a.resume()}function X(a){let b=this[y];b.readyState!==J.CLOSED&&(b.readyState===J.OPEN&&(b._readyState=J.CLOSING,Y(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function Y(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),a._closeTimeout)}function Z(){let a=this[y];if(this.removeListener("close",Z),this.removeListener("data",$),this.removeListener("end",_),a._readyState=J.CLOSING,!this._readableState.endEmitted&&!a._closeFrameReceived&&!a._receiver._writableState.errorEmitted&&0!==this._readableState.length){let b=this.read(this._readableState.length);a._receiver.write(b)}a._receiver.end(),this[y]=void 0,clearTimeout(a._closeTimer),a._receiver._writableState.finished||a._receiver._writableState.errorEmitted?a.emitClose():(a._receiver.on("error",S),a._receiver.on("finish",S))}function $(a){this[y]._receiver.write(a)||this.pause()}function _(){let a=this[y];a._readyState=J.CLOSING,a._receiver.end(),this.end()}function aa(){let a=this[y];this.removeListener("error",aa),this.on("error",z),a&&(a._readyState=J.CLOSING,this.destroy())}Object.defineProperty(J,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J.prototype,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J.prototype,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J.prototype,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),Object.defineProperty(J.prototype,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(J.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(J.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[v])return b[w];return null},set(b){for(let b of this.listeners(a))if(b[v]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[v]:!0})}})}),J.prototype.addEventListener=A,J.prototype.removeEventListener=B,b.exports=J},29e3,(a,b,c)=>{"use strict";a.r(89877);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},71553,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},95837,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(20529),i=a.r(19199),j=a.r(71553),k=a.r(89877),{CLOSE_TIMEOUT:l,GUID:m,kWebSocket:n}=a.r(65514),o=/^[+/0-9A-Za-z]{22}==$/;function p(a){a._state=2,a.emit("close")}function q(){this.destroy()}function r(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function s(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,s),a.emit("wsClientError",d,c,b)}else r(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,closeTimeout:l,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(p,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{p(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",q);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void s(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void s(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!o.test(e))return void s(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void s(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void r(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){s(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],n={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),n[i.extensionName]=c)}catch(c){s(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return r(b,g||401,h,i);this.completeUpgrade(n,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return r(b,401)}this.completeUpgrade(n,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[n])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return r(e,503);let k=g("sha1").update(b+m).digest("base64"),l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],o=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(l.push(`Sec-WebSocket-Protocol: ${a}`),o._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});l.push(`Sec-WebSocket-Extensions: ${c}`),o._extensions=a}this.emit("headers",l,d),e.write(l.concat("\r\n").join("\r\n")),e.removeListener("error",q),o.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(o),o.on("close",()=>{this.clients.delete(o),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)})),j(o,d)}}},60350,a=>{"use strict";let b,c,d;var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8=a.i(87924),a9=a.i(72131);let ba="/api/transactions",bb="/api/dealers",bc={getTransactions:async()=>{let a=await fetch(ba);if(!a.ok)throw Error("Failed to load data");return a.json()},saveTransaction:async a=>{let b=await fetch(ba,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error("Failed to save data");return b.json()},updatePaymentStatus:async(a,b)=>{if(!(await fetch(`${ba}/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPaid:b})})).ok)throw Error("Failed to update status");return bc.getTransactions()},updateTransaction:async(a,b)=>{if(!(await fetch(`${ba}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok)throw Error("Failed to update transaction");return bc.getTransactions()},deleteTransaction:async a=>{if(!(await fetch(`${ba}/${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete");return bc.getTransactions()},getDealers:async()=>{let a=await fetch(bb);if(!a.ok)throw Error("Failed to load dealers");return a.json()},addDealer:async a=>{let b=await fetch(bb,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});if(!b.ok)throw Error("Failed to add dealer");return b.json()},updateDealer:async(a,b)=>{if(!(await fetch(bb,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,name:b})})).ok)throw Error("Failed to update dealer")}};a.i(28684),a.i(22734),a.i(24868),a.i(81111),a.i(88646),a.i(29e3),a.i(75091),a.i(10697);var bd=a.i(89877);function be(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function bf(a){return this instanceof bf?(this.v=a,this):new bf(a)}function bg(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof bf?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function bh(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}a.i(95837),bd.default,a.i(14747),(e=ag||(ag={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(f=ah||(ah={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",f.PYTHON="PYTHON",(g=ai||(ai={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",g.SILENT="SILENT",g.WHEN_IDLE="WHEN_IDLE",g.INTERRUPT="INTERRUPT",(h=aj||(aj={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",h.STRING="STRING",h.NUMBER="NUMBER",h.INTEGER="INTEGER",h.BOOLEAN="BOOLEAN",h.ARRAY="ARRAY",h.OBJECT="OBJECT",h.NULL="NULL",(i=ak||(ak={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH",(j=al||(al={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",j.NO_AUTH="NO_AUTH",j.API_KEY_AUTH="API_KEY_AUTH",j.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",j.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",j.OAUTH="OAUTH",j.OIDC_AUTH="OIDC_AUTH",(k=am||(am={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",k.HTTP_IN_QUERY="HTTP_IN_QUERY",k.HTTP_IN_HEADER="HTTP_IN_HEADER",k.HTTP_IN_PATH="HTTP_IN_PATH",k.HTTP_IN_BODY="HTTP_IN_BODY",k.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(l=an||(an={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",l.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",l.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",l.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",l.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",l.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",l.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(m=ao||(ao={})).UNSPECIFIED="UNSPECIFIED",m.BLOCKING="BLOCKING",m.NON_BLOCKING="NON_BLOCKING",(n=ap||(ap={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC",(o=aq||(aq={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE",o.VALIDATED="VALIDATED",(p=ar||(ar={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",p.LOW="LOW",p.MEDIUM="MEDIUM",p.HIGH="HIGH",p.MINIMAL="MINIMAL",(q=as||(as={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",q.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",q.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",q.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",q.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",q.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",q.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",q.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",q.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",q.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",q.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(r=at||(at={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",r.SEVERITY="SEVERITY",r.PROBABILITY="PROBABILITY",(s=au||(au={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE",s.OFF="OFF",(t=av||(av={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER",(u=aw||(aw={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",u.NEGLIGIBLE="NEGLIGIBLE",u.LOW="LOW",u.MEDIUM="MEDIUM",u.HIGH="HIGH",(v=ax||(ax={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",v.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",v.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",v.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",v.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(w=ay||(ay={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",w.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",w.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",w.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",w.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(x=az||(az={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",x.SAFETY="SAFETY",x.OTHER="OTHER",x.BLOCKLIST="BLOCKLIST",x.PROHIBITED_CONTENT="PROHIBITED_CONTENT",x.IMAGE_SAFETY="IMAGE_SAFETY",x.MODEL_ARMOR="MODEL_ARMOR",x.JAILBREAK="JAILBREAK",(y=aA||(aA={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",y.ON_DEMAND="ON_DEMAND",y.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(z=aB||(aB={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",z.TEXT="TEXT",z.IMAGE="IMAGE",z.AUDIO="AUDIO",(A=aC||(aC={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",A.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",A.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",A.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(B=aD||(aD={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",B.TUNING_MODE_FULL="TUNING_MODE_FULL",B.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(C=aE||(aE={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",C.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",C.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",C.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",C.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",C.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",C.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(D=aF||(aF={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",D.JOB_STATE_QUEUED="JOB_STATE_QUEUED",D.JOB_STATE_PENDING="JOB_STATE_PENDING",D.JOB_STATE_RUNNING="JOB_STATE_RUNNING",D.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",D.JOB_STATE_FAILED="JOB_STATE_FAILED",D.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",D.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",D.JOB_STATE_PAUSED="JOB_STATE_PAUSED",D.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",D.JOB_STATE_UPDATING="JOB_STATE_UPDATING",D.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(E=aG||(aG={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",E.TUNING_TASK_I2V="TUNING_TASK_I2V",E.TUNING_TASK_T2V="TUNING_TASK_T2V",E.TUNING_TASK_R2V="TUNING_TASK_R2V",(F=aH||(aH={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",F.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",F.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",F.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",F.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(G=aI||(aI={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",G.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",G.BALANCED="BALANCED",G.PRIORITIZE_COST="PRIORITIZE_COST",(H=aJ||(aJ={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",H.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(I=aK||(aK={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",I.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",I.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",I.BLOCK_NONE="BLOCK_NONE",(J=aL||(aL={})).DONT_ALLOW="DONT_ALLOW",J.ALLOW_ADULT="ALLOW_ADULT",J.ALLOW_ALL="ALLOW_ALL",(K=aM||(aM={})).auto="auto",K.en="en",K.ja="ja",K.ko="ko",K.hi="hi",K.zh="zh",K.pt="pt",K.es="es",(L=aN||(aN={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",L.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",L.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",L.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",L.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(M=aO||(aO={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",M.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",M.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",M.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(N=aP||(aP={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",N.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",N.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",N.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(O=aQ||(aQ={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",O.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",O.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",O.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",O.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",O.EDIT_MODE_STYLE="EDIT_MODE_STYLE",O.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",O.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(P=aR||(aR={})).FOREGROUND="FOREGROUND",P.BACKGROUND="BACKGROUND",P.PROMPT="PROMPT",P.SEMANTIC="SEMANTIC",P.INTERACTIVE="INTERACTIVE",(Q=aS||(aS={})).ASSET="ASSET",Q.STYLE="STYLE",(R=aT||(aT={})).INSERT="INSERT",R.REMOVE="REMOVE",R.REMOVE_STATIC="REMOVE_STATIC",R.OUTPAINT="OUTPAINT",(S=aU||(aU={})).OPTIMIZED="OPTIMIZED",S.LOSSLESS="LOSSLESS",(T=aV||(aV={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",T.PREFERENCE_TUNING="PREFERENCE_TUNING",(U=aW||(aW={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",U.STATE_PENDING="STATE_PENDING",U.STATE_ACTIVE="STATE_ACTIVE",U.STATE_FAILED="STATE_FAILED",(V=aX||(aX={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",V.PROCESSING="PROCESSING",V.ACTIVE="ACTIVE",V.FAILED="FAILED",(W=aY||(aY={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",W.UPLOADED="UPLOADED",W.GENERATED="GENERATED",W.REGISTERED="REGISTERED",(X=aZ||(aZ={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",X.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",X.RESPONSE_REJECTED="RESPONSE_REJECTED",X.NEED_MORE_INPUT="NEED_MORE_INPUT",(Y=a$||(a$={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Y.TEXT="TEXT",Y.IMAGE="IMAGE",Y.VIDEO="VIDEO",Y.AUDIO="AUDIO",Y.DOCUMENT="DOCUMENT",(Z=a_||(a_={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",Z.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",Z.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",($=a0||(a0={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",$.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",$.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(_=a1||(a1={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",_.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",_.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(aa=a2||(a2={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",aa.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",aa.NO_INTERRUPTION="NO_INTERRUPTION",(ab=a3||(a3={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",ab.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",ab.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(ac=a4||(a4={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",ac.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",ac.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",ac.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",ac.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",ac.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",ac.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",ac.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",ac.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",ac.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",ac.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",ac.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",ac.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(ad=a5||(a5={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",ad.QUALITY="QUALITY",ad.DIVERSITY="DIVERSITY",ad.VOCALIZATION="VOCALIZATION",(ae=a6||(a6={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",ae.PLAY="PLAY",ae.PAUSE="PAUSE",ae.STOP="STOP",ae.RESET_CONTEXT="RESET_CONTEXT",(af=a7||(a7={})).PAGED_ITEM_BATCH_JOBS="batchJobs",af.PAGED_ITEM_MODELS="models",af.PAGED_ITEM_TUNING_JOBS="tuningJobs",af.PAGED_ITEM_FILES="files",af.PAGED_ITEM_CACHED_CONTENTS="cachedContents",af.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",af.PAGED_ITEM_DOCUMENTS="documents","function"==typeof SuppressedError&&SuppressedError;let bi=function(){let{crypto:a}=globalThis;if(null==a?void 0:a.randomUUID)return bi=a.randomUUID.bind(a),a.randomUUID();let b=new Uint8Array(1),c=a?()=>a.getRandomValues(b)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^c()&15>>a/4).toString(16))};function bj(a){return"object"==typeof a&&null!==a&&("name"in a&&"AbortError"===a.name||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}let bk=a=>{if(a instanceof Error)return a;if("object"==typeof a&&null!==a){try{if("[object Error]"===Object.prototype.toString.call(a)){let b=Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(b.stack=a.stack),a.cause&&!b.cause&&(b.cause=a.cause),a.name&&(b.name=a.name),b}}catch(a){}try{return Error(JSON.stringify(a))}catch(a){}}return Error(a)};class bl extends Error{}class bm extends bl{constructor(a,b,c,d){super(`${bm.makeMessage(a,b,c)}`),this.status=a,this.headers=d,this.error=b}static makeMessage(a,b,c){let d=(null==b?void 0:b.message)?"string"==typeof b.message?b.message:JSON.stringify(b.message):b?JSON.stringify(b):c;return a&&d?`${a} ${d}`:a?`${a} status code (no body)`:d||"(no status code or body)"}static generate(a,b,c,d){return a&&d?400===a?new bq(a,b,c,d):401===a?new br(a,b,c,d):403===a?new bs(a,b,c,d):404===a?new bt(a,b,c,d):409===a?new bu(a,b,c,d):422===a?new bv(a,b,c,d):429===a?new bw(a,b,c,d):a>=500?new bx(a,b,c,d):new bm(a,b,c,d):new bo({message:c,cause:bk(b)})}}class bn extends bm{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class bo extends bm{constructor({message:a,cause:b}){super(void 0,void 0,a||"Connection error.",void 0),b&&(this.cause=b)}}class bp extends bo{constructor({message:a}={}){super({message:null!=a?a:"Request timed out."})}}class bq extends bm{}class br extends bm{}class bs extends bm{}class bt extends bm{}class bu extends bm{}class bv extends bm{}class bw extends bm{}class bx extends bm{}let by=/^[a-z][a-z0-9+.-]*:/i,bz=a=>(bz=Array.isArray)(a),bA=bz,bB="0.0.1",bC=a=>"x32"===a?"x32":"x86_64"===a||"x64"===a?"x64":"arm"===a?"arm":"aarch64"===a||"arm64"===a?"arm64":a?`other:${a}`:"unknown",bD=a=>(a=a.toLowerCase()).includes("ios")?"iOS":"android"===a?"Android":"darwin"===a?"MacOS":"win32"===a?"Windows":"freebsd"===a?"FreeBSD":"openbsd"===a?"OpenBSD":"linux"===a?"Linux":a?`Other:${a}`:"Unknown";function bE(...a){let b=globalThis.ReadableStream;if(void 0===b)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new b(...a)}function bF(a){if(a[Symbol.asyncIterator])return a;let b=a.getReader();return{async next(){try{let a=await b.read();return(null==a?void 0:a.done)&&b.releaseLock(),a}catch(a){throw b.releaseLock(),a}},async return(){let a=b.cancel();return b.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function bG(a){var b,c;if(null===a||"object"!=typeof a)return;if(a[Symbol.asyncIterator])return void await (null==(c=(b=a[Symbol.asyncIterator]()).return)?void 0:c.call(b));let d=a.getReader(),e=d.cancel();d.releaseLock(),await e}let bH=({headers:a,body:b})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(b)}),bI=()=>{var a;if("undefined"==typeof File){let{process:b}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null==(a=null==b?void 0:b.versions)?void 0:a.node)&&20>parseInt(b.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function bJ(a,b,c){return bI(),new File(a,null!=b?b:"unknown_file",c)}let bK=a=>null!=a&&"object"==typeof a&&"number"==typeof a.size&&"string"==typeof a.type&&"function"==typeof a.text&&"function"==typeof a.slice&&"function"==typeof a.arrayBuffer;async function bL(a,b,c){var d;let e,f;if(bI(),null!=(e=a=await a)&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&bK(e))return a instanceof File?a:bJ([await a.arrayBuffer()],a.name);if(null!=(f=a)&&"object"==typeof f&&"string"==typeof f.url&&"function"==typeof f.blob){let d=await a.blob();return b||(b=new URL(a.url).pathname.split(/[\\/]/).pop()),bJ(await bM(d),b,c)}let g=await bM(a);if(b||(b=("object"==typeof(d=a)&&null!==d&&("name"in d&&d.name&&String(d.name)||"url"in d&&d.url&&String(d.url)||"filename"in d&&d.filename&&String(d.filename)||"path"in d&&d.path&&String(d.path))||"").split(/[\\/]/).pop()||void 0),!(null==c?void 0:c.type)){let a=g.find(a=>"object"==typeof a&&"type"in a&&a.type);"string"==typeof a&&(c=Object.assign(Object.assign({},c),{type:a}))}return bJ(g,b,c)}async function bM(a){let b=[];if("string"==typeof a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)b.push(a);else if(bK(a))b.push(a instanceof Blob?a:await a.arrayBuffer());else if(null!=a&&"object"==typeof a&&"function"==typeof a[Symbol.asyncIterator])try{for(var c,d,e,f,g,h,i=!0,j=bh(a);!(c=(h=await j.next()).done);i=!0)f=h.value,i=!1,b.push(...await bM(f))}catch(a){d={error:a}}finally{try{!i&&!c&&(e=j.return)&&await e.call(j)}finally{if(d)throw d.error}}else{let b=null==(g=null==a?void 0:a.constructor)?void 0:g.name;throw Error(`Unexpected data type: ${typeof a}${b?`; constructor: ${b}`:""}${function(a){if("object"!=typeof a||null===a)return"";let b=Object.getOwnPropertyNames(a);return`; props: [${b.map(a=>`"${a}"`).join(", ")}]`}(a)}`)}return b}class bN{constructor(a){this._client=a}}function bO(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}bN._key=[];let bP=Object.freeze(Object.create(null)),bQ=((a=bO)=>function(b,...c){let d;if(1===b.length)return b[0];let e=!1,f=[],g=b.reduce((b,d,g)=>{var h,i,j;/[?#]/.test(d)&&(e=!0);let k=c[g],l=(e?encodeURIComponent:a)(""+k);return g!==c.length&&(null==k||"object"==typeof k&&k.toString===(null==(j=Object.getPrototypeOf(null!=(i=Object.getPrototypeOf(null!=(h=k.hasOwnProperty)?h:bP))?i:bP))?void 0:j.toString))&&(l=k+"",f.push({start:b.length+d.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),b+d+(g===c.length?"":l)},""),h=g.split(/[?#]/,1)[0],i=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(d=i.exec(h));)f.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(f.sort((a,b)=>a.start-b.start),f.length>0){let a=0,b=f.reduce((b,c)=>{let d=" ".repeat(c.start-a),e="^".repeat(c.length);return a=c.start+c.length,b+d+e},"");throw new bl(`Path parameters result in path with invalid segments:
${f.map(a=>a.error).join("\n")}
${g}
${b}`)}return g})(bO);class bR extends bN{create(a,b){var c;let{api_version:d=this._client.apiVersion}=a,e=be(a,["api_version"]);if("model"in e&&"agent_config"in e)throw new bl("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in e&&"generation_config"in e)throw new bl("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(bQ`/${d}/interactions`,Object.assign(Object.assign({body:e},b),{stream:null!=(c=a.stream)&&c}))}delete(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.delete(bQ`/${d}/interactions/${a}`,c)}cancel(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.post(bQ`/${d}/interactions/${a}/cancel`,c)}get(a,b={},c){var d;let e=null!=b?b:{},{api_version:f=this._client.apiVersion}=e,g=be(e,["api_version"]);return this._client.get(bQ`/${f}/interactions/${a}`,Object.assign(Object.assign({query:g},c),{stream:null!=(d=null==b?void 0:b.stream)&&d}))}}bR._key=Object.freeze(["interactions"]);class bS extends bR{}function bT(a){let b;return(null!=c?c:c=(b=new globalThis.TextEncoder).encode.bind(b))(a)}function bU(a){let b;return(null!=d?d:d=(b=new globalThis.TextDecoder).decode.bind(b))(a)}class bV{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){let b;if(null==a)return[];let c=a instanceof ArrayBuffer?new Uint8Array(a):"string"==typeof a?bT(a):a;this.buffer=function(a){let b=0;for(let c of a)b+=c.length;let c=new Uint8Array(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}([this.buffer,c]);let d=[];for(;null!=(b=function(a,b){for(let c=null!=b?b:0;c<a.length;c++){if(10===a[c])return{preceding:c,index:c+1,carriage:!1};if(13===a[c])return{preceding:c,index:c+1,carriage:!0}}return null}(this.buffer,this.carriageReturnIndex));){if(b.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=b.index;continue}if(null!=this.carriageReturnIndex&&(b.index!==this.carriageReturnIndex+1||b.carriage)){d.push(bU(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let a=null!==this.carriageReturnIndex?b.preceding-1:b.preceding,c=bU(this.buffer.subarray(0,a));d.push(c),this.buffer=this.buffer.subarray(b.index),this.carriageReturnIndex=null}return d}flush(){return this.buffer.length?this.decode("\n"):[]}}bV.NEWLINE_CHARS=new Set(["\n","\r"]),bV.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let bW={off:0,error:200,warn:300,info:400,debug:500},bX=(a,b,c)=>{if(a){if(Object.prototype.hasOwnProperty.call(bW,a))return a;b0(c).warn(`${b} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(bW))}`)}};function bY(){}function bZ(a,b,c){return!b||bW[a]>bW[c]?bY:b[a].bind(b)}let b$={error:bY,warn:bY,info:bY,debug:bY},b_=new WeakMap;function b0(a){var b;let c=a.logger,d=null!=(b=a.logLevel)?b:"off";if(!c)return b$;let e=b_.get(c);if(e&&e[0]===d)return e[1];let f={error:bZ("error",c,d),warn:bZ("warn",c,d),info:bZ("info",c,d),debug:bZ("debug",c,d)};return b_.set(c,[d,f]),f}let b1=a=>(a.options&&(a.options=Object.assign({},a.options),delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([a,b])=>[a,"x-goog-api-key"===a.toLowerCase()||"authorization"===a.toLowerCase()||"cookie"===a.toLowerCase()||"set-cookie"===a.toLowerCase()?"***":b]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class b2{constructor(a,b,c){this.iterator=a,this.controller=b,this.client=c}static fromSSEResponse(a,b,c){let d=!1,e=c?b0(c):console;return new b2(function(){return bg(this,arguments,function*(){var c,f,g,h;if(d)throw new bl("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let i=!1;try{try{for(var j,k=!0,l=bh(function(a,b){return bg(this,arguments,function*(){var c,d,e,f;if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new bl("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new bl("Attempted to iterate over a response with no body")}let g=new b3,h=new bV,i=bF(a.body);try{for(var j,k=!0,l=bh(function(a){return bg(this,arguments,function*(){var b,c,d,e;let f=new Uint8Array;try{for(var g,h=!0,i=bh(a);!(b=(g=yield bf(i.next())).done);h=!0){let a;if(e=g.value,h=!1,null==e)continue;let b=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?bT(e):e,c=new Uint8Array(f.length+b.length);for(c.set(f),c.set(b,f.length),f=c;-1!==(a=function(a){for(let b=0;b<a.length-1;b++){if(10===a[b]&&10===a[b+1]||13===a[b]&&13===a[b+1])return b+2;if(13===a[b]&&10===a[b+1]&&b+3<a.length&&13===a[b+2]&&10===a[b+3])return b+4}return -1}(f));)yield yield bf(f.slice(0,a)),f=f.slice(a)}}catch(a){c={error:a}}finally{try{!h&&!b&&(d=i.return)&&(yield bf(d.call(i)))}finally{if(c)throw c.error}}f.length>0&&(yield yield bf(f))})}(i));!(c=(j=yield bf(l.next())).done);k=!0)for(let a of(f=j.value,k=!1,h.decode(f))){let b=g.decode(a);b&&(yield yield bf(b))}}catch(a){d={error:a}}finally{try{!k&&!c&&(e=l.return)&&(yield bf(e.call(l)))}finally{if(d)throw d.error}}for(let a of h.flush()){let b=g.decode(a);b&&(yield yield bf(b))}})}(a,b));!(c=(j=yield bf(l.next())).done);k=!0)if(h=j.value,k=!1,!i)if(h.data.startsWith("[DONE]")){i=!0;continue}else try{yield yield bf(JSON.parse(h.data))}catch(a){throw e.error("Could not parse message into JSON:",h.data),e.error("From chunk:",h.raw),a}}catch(a){f={error:a}}finally{try{!k&&!c&&(g=l.return)&&(yield bf(g.call(l)))}finally{if(f)throw f.error}}i=!0}catch(a){if(bj(a))return yield bf(void 0);throw a}finally{i||b.abort()}})},b,c)}static fromReadableStream(a,b,c){let d=!1;return new b2(function(){return bg(this,arguments,function*(){var c,e,f,g;if(d)throw new bl("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let h=!1;try{try{for(var i,j=!0,k=bh(function(){return bg(this,arguments,function*(){var b,c,d,e;let f=new bV,g=bF(a);try{for(var h,i=!0,j=bh(g);!(b=(h=yield bf(j.next())).done);i=!0)for(let a of(e=h.value,i=!1,f.decode(e)))yield yield bf(a)}catch(a){c={error:a}}finally{try{!i&&!b&&(d=j.return)&&(yield bf(d.call(j)))}finally{if(c)throw c.error}}for(let a of f.flush())yield yield bf(a)})}());!(c=(i=yield bf(k.next())).done);j=!0)g=i.value,j=!1,!h&&g&&(yield yield bf(JSON.parse(g)))}catch(a){e={error:a}}finally{try{!j&&!c&&(f=k.return)&&(yield bf(f.call(k)))}finally{if(e)throw e.error}}h=!0}catch(a){if(bj(a))return yield bf(void 0);throw a}finally{h||b.abort()}})},b,c)}[Symbol.asyncIterator](){return this.iterator()}tee(){let a=[],b=[],c=this.iterator(),d=d=>({next:()=>{if(0===d.length){let d=c.next();a.push(d),b.push(d)}return d.shift()}});return[new b2(()=>d(a),this.controller,this.client),new b2(()=>d(b),this.controller,this.client)]}toReadableStream(){let a,b=this;return bE({async start(){a=b[Symbol.asyncIterator]()},async pull(b){try{let{value:c,done:d}=await a.next();if(d)return b.close();let e=bT(JSON.stringify(c)+"\n");b.enqueue(e)}catch(a){b.error(a)}},async cancel(){var b;await (null==(b=a.return)?void 0:b.call(a))}})}}class b3{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){var b;let c;if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;let a={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(a),a.startsWith(":"))return null;let[d,e,f]=-1!==(c=(b=a).indexOf(":"))?[b.substring(0,c),":",b.substring(c+1)]:[b,"",""];return f.startsWith(" ")&&(f=f.substring(1)),"event"===d?this.event=f:"data"===d&&this.data.push(f),null}}async function b4(a,b){let{response:c,requestLogID:d,retryOfRequestLogID:e,startTime:f}=b,g=await (async()=>{var d;if(b.options.stream)return(b0(a).debug("response",c.status,c.url,c.headers,c.body),b.options.__streamClass)?b.options.__streamClass.fromSSEResponse(c,b.controller,a):b2.fromSSEResponse(c,b.controller,a);if(204===c.status)return null;if(b.options.__binaryResponse)return c;let e=c.headers.get("content-type"),f=null==(d=null==e?void 0:e.split(";")[0])?void 0:d.trim();return(null==f?void 0:f.includes("application/json"))||(null==f?void 0:f.endsWith("+json"))?await c.json():await c.text()})();return b0(a).debug(`[${d}] response parsed`,b1({retryOfRequestLogID:e,url:c.url,status:c.status,body:g,durationMs:Date.now()-f})),g}class b5 extends Promise{constructor(a,b,c=b4){super(a=>{a(null)}),this.responsePromise=b,this.parseResponse=c,this.client=a}_thenUnwrap(a){return new b5(this.client,this.responsePromise,async(b,c)=>a(await this.parseResponse(b,c),c))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){let[a,b]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:b}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,b){return this.parse().then(a,b)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}let b6=Symbol("brand.privateNullableHeaders"),b7=a=>{let b=new Headers,c=new Set;for(let d of a){let a=new Set;for(let[e,f]of function*(a){let b;if(!a)return;if(b6 in a){let{values:b,nulls:c}=a;for(let a of(yield*b.entries(),c))yield[a,null];return}let c=!1;for(let d of(a instanceof Headers?b=a.entries():bA(a)?b=a:(c=!0,b=Object.entries(null!=a?a:{})),b)){let a=d[0];if("string"!=typeof a)throw TypeError("expected header name to be a string");let b=bA(d[1])?d[1]:[d[1]],e=!1;for(let d of b)void 0!==d&&(c&&!e&&(e=!0,yield[a,null]),yield[a,d])}}(d)){let d=e.toLowerCase();a.has(d)||(b.delete(e),a.add(d)),null===f?(b.delete(e),c.add(d)):(b.append(e,f),c.delete(d))}}return{[b6]:!0,values:b,nulls:c}},b8=a=>{var b,c,d,e,f,g;return void 0!==globalThis.process?null!=(d=null==(c=null==(b=globalThis.process.env)?void 0:b[a])?void 0:c.trim())?d:void 0:void 0!==globalThis.Deno?null==(g=null==(f=null==(e=globalThis.Deno.env)?void 0:e.get)?void 0:f.call(e,a))?void 0:g.trim():void 0};class b9{constructor(a){var b,c,d,e,f,g,h,{baseURL:i=b8("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:j=null!=(b=b8("GEMINI_API_KEY"))?b:null,apiVersion:k="v1beta"}=a;const l=Object.assign(Object.assign({apiKey:j,apiVersion:k},be(a,["baseURL","apiKey","apiVersion"])),{baseURL:i||"https://generativelanguage.googleapis.com"});this.baseURL=l.baseURL,this.timeout=null!=(c=l.timeout)?c:b9.DEFAULT_TIMEOUT,this.logger=null!=(d=l.logger)?d:console;const m="warn";this.logLevel=m,this.logLevel=null!=(f=null!=(e=bX(l.logLevel,"ClientOptions.logLevel",this))?e:bX(b8("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))?f:m,this.fetchOptions=l.fetchOptions,this.maxRetries=null!=(g=l.maxRetries)?g:2,this.fetch=null!=(h=l.fetch)?h:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=bH,this._options=l,this.apiKey=j,this.apiVersion=k,this.clientAdapter=l.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:b}){if(!(a.has("authorization")||a.has("x-goog-api-key")||this.apiKey&&a.get("x-goog-api-key"))&&!b.has("x-goog-api-key"))throw Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){let b=b7([a.headers]);if(!(b.values.has("authorization")||b.values.has("x-goog-api-key"))){if(this.apiKey)return b7([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return b7([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([a,b])=>void 0!==b).map(([a,b])=>{if("string"==typeof b||"number"==typeof b||"boolean"==typeof b)return`${encodeURIComponent(a)}=${encodeURIComponent(b)}`;if(null===b)return`${encodeURIComponent(a)}=`;throw new bl(`Cannot stringify type ${typeof b}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${bB}`}defaultIdempotencyKey(){return`stainless-node-retry-${bi()}`}makeStatusError(a,b,c,d){return bm.generate(a,b,c,d)}buildURL(a,b,c){let d=!this.baseURLOverridden()&&c||this.baseURL,e=new URL(by.test(a)?a:d+(d.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return!function(a){if(!a)return!0;for(let b in a)return!1;return!0}(f)&&(b=Object.assign(Object.assign({},f),b)),"object"==typeof b&&b&&!Array.isArray(b)&&(e.search=this.stringifyQuery(b)),e.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){let b=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${b}`}}async prepareRequest(a,{url:b,options:c}){}get(a,b){return this.methodRequest("get",a,b)}post(a,b){return this.methodRequest("post",a,b)}patch(a,b){return this.methodRequest("patch",a,b)}put(a,b){return this.methodRequest("put",a,b)}delete(a,b){return this.methodRequest("delete",a,b)}methodRequest(a,b,c){return this.request(Promise.resolve(c).then(c=>Object.assign({method:a,path:b},c)))}request(a,b=null){return new b5(this,this.makeRequest(a,b,void 0))}async makeRequest(a,b,c){var d,e,f;let g=await a,h=null!=(d=g.maxRetries)?d:this.maxRetries;null==b&&(b=h),await this.prepareOptions(g);let{req:i,url:j,timeout:k}=await this.buildRequest(g,{retryCount:h-b});await this.prepareRequest(i,{url:j,options:g});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),m=void 0===c?"":`, retryOf: ${c}`,n=Date.now();if(b0(this).debug(`[${l}] sending request`,b1({retryOfRequestLogID:c,method:g.method,url:j,options:g,headers:i.headers})),null==(e=g.signal)?void 0:e.aborted)throw new bn;let o=new AbortController,p=await this.fetchWithTimeout(j,i,k,o).catch(bk),q=Date.now();if(p instanceof globalThis.Error){let a=`retrying, ${b} attempts remaining`;if(null==(f=g.signal)?void 0:f.aborted)throw new bn;let d=bj(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(b)return b0(this).info(`[${l}] connection ${d?"timed out":"failed"} - ${a}`),b0(this).debug(`[${l}] connection ${d?"timed out":"failed"} (${a})`,b1({retryOfRequestLogID:c,url:j,durationMs:q-n,message:p.message})),this.retryRequest(g,b,null!=c?c:l);if(b0(this).info(`[${l}] connection ${d?"timed out":"failed"} - error; no more retries left`),b0(this).debug(`[${l}] connection ${d?"timed out":"failed"} (error; no more retries left)`,b1({retryOfRequestLogID:c,url:j,durationMs:q-n,message:p.message})),d)throw new bp;throw new bo({cause:p})}let r=`[${l}${m}] ${i.method} ${j} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${q-n}ms`;if(!p.ok){let a=await this.shouldRetry(p);if(b&&a){let a=`retrying, ${b} attempts remaining`;return await bG(p.body),b0(this).info(`${r} - ${a}`),b0(this).debug(`[${l}] response error (${a})`,b1({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,durationMs:q-n})),this.retryRequest(g,b,null!=c?c:l,p.headers)}let d=a?"error; no more retries left":"error; not retryable";b0(this).info(`${r} - ${d}`);let e=await p.text().catch(a=>bk(a).message),f=(a=>{try{return JSON.parse(a)}catch(a){return}})(e),h=f?void 0:e;throw b0(this).debug(`[${l}] response error (${d})`,b1({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,message:h,durationMs:Date.now()-n})),this.makeStatusError(p.status,f,h,p.headers)}return b0(this).info(r),b0(this).debug(`[${l}] response start`,b1({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,durationMs:q-n})),{response:p,options:g,controller:o,requestLogID:l,retryOfRequestLogID:c,startTime:n}}async fetchWithTimeout(a,b,c,d){let e=b||{},{signal:f,method:g}=e,h=be(e,["signal","method"]);f&&f.addEventListener("abort",()=>d.abort());let i=setTimeout(()=>d.abort(),c),j=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||"object"==typeof h.body&&null!==h.body&&Symbol.asyncIterator in h.body,k=Object.assign(Object.assign(Object.assign({signal:d.signal},j?{duplex:"half"}:{}),{method:"GET"}),h);g&&(k.method=g.toUpperCase());try{return await this.fetch.call(void 0,a,k)}finally{clearTimeout(i)}}async shouldRetry(a){let b=a.headers.get("x-should-retry");return"true"===b||"false"!==b&&(408===a.status||409===a.status||429===a.status||!!(a.status>=500))}async retryRequest(a,b,c,d){var e;let f,g,h=null==d?void 0:d.get("retry-after-ms");if(h){let a=parseFloat(h);Number.isNaN(a)||(f=a)}let i=null==d?void 0:d.get("retry-after");if(i&&!f){let a=parseFloat(i);f=Number.isNaN(a)?Date.parse(i)-Date.now():1e3*a}if(!(f&&0<=f&&f<6e4)){let c=null!=(e=a.maxRetries)?e:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(b,c)}return await (g=f,new Promise(a=>setTimeout(a,g))),this.makeRequest(a,b-1,c)}calculateDefaultRetryTimeoutMillis(a,b){return Math.min(.5*Math.pow(2,b-a),8)*(1-.25*Math.random())*1e3}async buildRequest(a,{retryCount:b=0}={}){var c,d,e;let f=Object.assign({},a),{method:g,path:h,query:i,defaultBaseURL:j}=f,k=this.buildURL(h,i,j);"timeout"in f&&((a,b)=>{if("number"!=typeof b||!Number.isInteger(b))throw new bl(`${a} must be an integer`);if(b<0)throw new bl(`${a} must be a positive integer`)})("timeout",f.timeout),f.timeout=null!=(c=f.timeout)?c:this.timeout;let{bodyHeaders:l,body:m}=this.buildBody({options:f}),n=await this.buildHeaders({options:a,method:g,bodyHeaders:l,retryCount:b});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:g,headers:n},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),null!=(d=this.fetchOptions)?d:{}),null!=(e=f.fetchOptions)?e:{}),url:k,timeout:f.timeout}}async buildHeaders({options:a,method:c,bodyHeaders:d,retryCount:e}){let f={};this.idempotencyHeader&&"get"!==c&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),f[this.idempotencyHeader]=a.idempotencyKey);let g=await this.authHeaders(a),h=b7([f,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(e)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),null!=b?b:b=(()=>{var a,b,c,d,e;let f="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bB,"X-Stainless-OS":bD(Deno.build.os),"X-Stainless-Arch":bC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!=(b=null==(a=Deno.version)?void 0:a.deno)?b:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bB,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bB,"X-Stainless-OS":bD(null!=(c=globalThis.process.platform)?c:"unknown"),"X-Stainless-Arch":bC(null!=(d=globalThis.process.arch)?d:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!=(e=globalThis.process.version)?e:"unknown"};let g=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:a,pattern:b}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let c=b.exec(navigator.userAgent);if(c){let b=c[1]||0,d=c[2]||0,e=c[3]||0;return{browser:a,version:`${b}.${d}.${e}`}}}return null}();return g?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bB,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${g.browser}`,"X-Stainless-Runtime-Version":g.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bB,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),this._options.defaultHeaders,d,a.headers,g]);return this.validateHeaders(h),h.values}buildBody({options:{body:a,headers:b}}){let c;if(!a)return{bodyHeaders:void 0,body:void 0};let d=b7([b]);if(ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||"string"==typeof a&&d.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream)return{bodyHeaders:void 0,body:a};if("object"!=typeof a||!(Symbol.asyncIterator in a)&&(!(Symbol.iterator in a)||!("next"in a)||"function"!=typeof a.next))return this.encoder({body:a,headers:d});return{bodyHeaders:void 0,body:(c=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator](),bE({start(){},async pull(a){let{done:b,value:d}=await c.next();b?a.close():a.enqueue(d)},async cancel(){var a;await (null==(a=c.return)?void 0:a.call(c))}}))}}}b9.DEFAULT_TIMEOUT=6e4;class ca extends b9{constructor(){super(...arguments),this.interactions=new bS(this)}}ca.GeminiNextGenAPIClient=ca,ca.GeminiNextGenAPIClientError=bl,ca.APIError=bm,ca.APIConnectionError=bo,ca.APIConnectionTimeoutError=bp,ca.APIUserAbortError=bn,ca.NotFoundError=bt,ca.ConflictError=bu,ca.RateLimitError=bw,ca.BadRequestError=bq,ca.AuthenticationError=br,ca.InternalServerError=bx,ca.PermissionDeniedError=bs,ca.UnprocessableEntityError=bv,ca.toFile=bL,ca.Interactions=bS;let cb=({stats:a})=>{let b=[{label:"Total Weight",value:`${a.totalWeight.toFixed(2)} kg`,icon:"fa-weight-hanging",color:"bg-blue-500"},{label:"Total Revenue",value:`LKR ${a.totalRevenue.toLocaleString()}`,icon:"fa-money-bill-wave",color:"bg-emerald-500"},{label:"Pending Payment",value:`LKR ${a.pendingAmount.toLocaleString()}`,icon:"fa-clock",color:"bg-amber-500"},{label:"Chickens Sold",value:a.totalChickens.toString(),icon:"fa-kiwi-bird",color:"bg-indigo-500"}];return(0,a8.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:b.map((a,b)=>(0,a8.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex items-center space-x-4",children:[(0,a8.jsx)("div",{className:`${a.color} w-12 h-12 rounded-xl flex items-center justify-center text-white text-xl shadow-lg shadow-opacity-20`,children:(0,a8.jsx)("i",{className:`fas ${a.icon}`})}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("p",{className:"text-sm font-medium text-slate-500",children:a.label}),(0,a8.jsx)("p",{className:"text-xl font-bold text-slate-800",children:a.value})]})]},b))})},cc=({onSave:a,onCancel:b,transaction:c,dealers:d,onAddDealer:e})=>{let[f,g]=(0,a9.useState)({dealerId:c?.dealerId||"",date:c?.date||new Date().toISOString().split("T")[0],chickenCount:c?.chickenCount||0,weightKg:c?.weightKg||0,pricePerKg:c?.pricePerKg||0,isPaid:c?.isPaid||!1,note:c?.note||""}),[h,i]=(0,a9.useState)(0),[j,k]=(0,a9.useState)(""),[l,m]=(0,a9.useState)(!1);return(0,a9.useEffect)(()=>{i(f.weightKg*f.pricePerKg)},[f.weightKg,f.pricePerKg]),(0,a8.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a8.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,a8.jsxs)("div",{className:"bg-emerald-600 p-6 text-white",children:[(0,a8.jsx)("h2",{className:"text-2xl font-bold",children:c?"Edit Delivery":"New Delivery"}),(0,a8.jsx)("p",{className:"opacity-80 text-sm",children:c?"Update chicken delivery details":"Enter chicken delivery details for the dealer"})]}),(0,a8.jsxs)("form",{onSubmit:b=>{(b.preventDefault(),f.weightKg<=0||f.pricePerKg<=0)?alert("Please enter valid weight and price."):a(f)},className:"p-6 space-y-4",children:[(0,a8.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a8.jsxs)("div",{className:"col-span-2",children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Dealer Name"}),(0,a8.jsxs)("div",{className:"flex space-x-2",children:[(0,a8.jsxs)("select",{required:!0,className:"flex-1 px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:f.dealerId,onChange:a=>g({...f,dealerId:a.target.value}),children:[(0,a8.jsx)("option",{value:"",children:"Select Dealer"}),d.map(a=>(0,a8.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,a8.jsx)("button",{type:"button",onClick:()=>m(!l),className:"px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl transition-all",children:(0,a8.jsx)("i",{className:"fas fa-plus"})})]}),l&&(0,a8.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,a8.jsx)("input",{type:"text",className:"flex-1 px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"New dealer name",value:j,onChange:a=>k(a.target.value)}),(0,a8.jsx)("button",{type:"button",onClick:()=>{j.trim()&&(e(j.trim()),k(""),m(!1))},className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-all text-sm",children:"Add"}),(0,a8.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-3 py-2 bg-slate-300 text-slate-700 rounded-lg hover:bg-slate-400 transition-all text-sm",children:"Cancel"})]})]}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Date"}),(0,a8.jsx)("input",{required:!0,type:"date",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:f.date,onChange:a=>g({...f,date:a.target.value})})]}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Chicken Count"}),(0,a8.jsx)("input",{required:!0,type:"number",min:"0",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:f.chickenCount||"",onChange:a=>g({...f,chickenCount:Number(a.target.value)}),placeholder:"0"})]}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Total Weight (kg)"}),(0,a8.jsx)("input",{required:!0,type:"number",step:"0.01",min:"0",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:f.weightKg||"",onChange:a=>g({...f,weightKg:Number(a.target.value)}),placeholder:"0.00"})]}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Price per kg (LKR)"}),(0,a8.jsx)("input",{required:!0,type:"number",min:"0",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:f.pricePerKg||"",onChange:a=>g({...f,pricePerKg:Number(a.target.value)}),placeholder:"0.00"})]})]}),(0,a8.jsxs)("div",{className:"col-span-2",children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Note (Optional)"}),(0,a8.jsx)("textarea",{className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all resize-none",rows:3,value:f.note,onChange:a=>g({...f,note:a.target.value}),placeholder:"Add any additional notes about this delivery..."})]}),(0,a8.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl flex justify-between items-center",children:[(0,a8.jsxs)("div",{children:[(0,a8.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wider font-bold",children:"Estimated Total"}),(0,a8.jsxs)("p",{className:"text-2xl font-black text-emerald-700",children:["LKR ",h.toLocaleString()]})]}),(0,a8.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer group",children:[(0,a8.jsx)("input",{type:"checkbox",className:"w-5 h-5 accent-emerald-600 cursor-pointer",checked:f.isPaid,onChange:a=>g({...f,isPaid:a.target.checked})}),(0,a8.jsx)("span",{className:"text-sm font-semibold text-slate-700 group-hover:text-emerald-600 transition-colors",children:"Already Paid?"})]})]}),(0,a8.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a8.jsx)("button",{type:"button",onClick:b,className:"flex-1 py-3 px-4 rounded-xl border-2 border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-all",children:"Cancel"}),(0,a8.jsx)("button",{type:"submit",className:"flex-2 py-3 px-8 rounded-xl bg-emerald-600 text-white font-bold hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all",children:c?"Update Record":"Add Record"})]})]})]})})},cd=({dealers:a,onAddDealer:b,onUpdateDealer:c,onClose:d})=>{let[e,f]=(0,a9.useState)(""),[g,h]=(0,a9.useState)(!1),[i,j]=(0,a9.useState)(null),[k,l]=(0,a9.useState)(""),m=()=>{e.trim()&&(b(e.trim()),f(""))},n=()=>{h(!1),j(null),l("")};return(0,a8.jsxs)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:[(0,a8.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,a8.jsxs)("div",{className:"bg-blue-600 p-6 text-white",children:[(0,a8.jsx)("h2",{className:"text-2xl font-bold",children:"Dealer Management"}),(0,a8.jsx)("p",{className:"opacity-80 text-sm",children:"Manage your dealer database"})]}),(0,a8.jsxs)("div",{className:"p-6",children:[(0,a8.jsxs)("div",{className:"mb-6",children:[(0,a8.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-3",children:"Add New Dealer"}),(0,a8.jsxs)("div",{className:"flex space-x-3",children:[(0,a8.jsx)("input",{type:"text",className:"flex-1 px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:"Dealer name",value:e,onChange:a=>f(a.target.value),onKeyPress:a=>"Enter"===a.key&&m()}),(0,a8.jsxs)("button",{onClick:m,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all font-bold",children:[(0,a8.jsx)("i",{className:"fas fa-plus mr-2"}),"Add"]})]})]}),(0,a8.jsxs)("div",{children:[(0,a8.jsxs)("h3",{className:"text-lg font-bold text-slate-800 mb-3",children:["Current Dealers (",a.length,")"]}),(0,a8.jsx)("div",{className:"max-h-96 overflow-y-auto",children:a.length>0?(0,a8.jsx)("div",{className:"space-y-2",children:a.map((a,b)=>(0,a8.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl",children:[(0,a8.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a8.jsx)("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center text-blue-600 font-bold",children:a.name.charAt(0).toUpperCase()}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("div",{className:"font-bold text-slate-800",children:a.name}),(0,a8.jsxs)("div",{className:"text-xs text-slate-500",children:["Added ",new Date(a.createdAt).toLocaleDateString()]})]})]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a8.jsxs)("div",{className:"text-sm text-slate-400 font-mono",children:["#",(b+1).toString().padStart(2,"0")]}),(0,a8.jsx)("button",{onClick:()=>{j(a),l(a.name),h(!0)},className:"w-8 h-8 flex items-center justify-center text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",children:(0,a8.jsx)("i",{className:"fas fa-edit text-sm"})})]})]},a.id))}):(0,a8.jsxs)("div",{className:"text-center py-12 text-slate-400",children:[(0,a8.jsx)("i",{className:"fas fa-users text-4xl mb-4"}),(0,a8.jsx)("p",{className:"font-medium",children:"No dealers added yet"}),(0,a8.jsx)("p",{className:"text-sm",children:"Add your first dealer above"})]})})]})]}),(0,a8.jsx)("div",{className:"p-6 border-t border-slate-100 flex justify-end",children:(0,a8.jsx)("button",{onClick:d,className:"px-6 py-3 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-all font-bold",children:"Close"})})]}),g&&i&&(0,a8.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a8.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,a8.jsxs)("div",{className:"bg-blue-600 p-6 text-white",children:[(0,a8.jsx)("h2",{className:"text-2xl font-bold",children:"Edit Dealer"}),(0,a8.jsx)("p",{className:"opacity-80 text-sm",children:"Update dealer information"})]}),(0,a8.jsx)("div",{className:"p-6",children:(0,a8.jsx)("div",{className:"space-y-4",children:(0,a8.jsxs)("div",{children:[(0,a8.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Dealer Name"}),(0,a8.jsx)("input",{type:"text",className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all",value:k,onChange:a=>l(a.target.value),placeholder:"Enter dealer name",autoFocus:!0})]})})}),(0,a8.jsxs)("div",{className:"p-6 border-t border-slate-100 flex justify-end space-x-3",children:[(0,a8.jsx)("button",{onClick:n,className:"px-6 py-3 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-all font-bold",children:"Cancel"}),(0,a8.jsx)("button",{onClick:()=>{i&&k.trim()&&(c(i.id,k.trim()),n())},className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all font-bold",children:"Save Changes"})]})]})})]})};a.s(["default",0,()=>{let[a,b]=(0,a9.useState)({transactions:[],isLoading:!0,dealers:[],filters:{search:"",status:"all",startDate:"",endDate:"",dealerId:""}}),[c,d]=(0,a9.useState)(!1),[e,f]=(0,a9.useState)(null),[g,h]=(0,a9.useState)(null),[i,j]=(0,a9.useState)(!1),[k,l]=(0,a9.useState)(null),[m,n]=(0,a9.useState)([]),[o,p]=(0,a9.useState)(!1),[q,r]=(0,a9.useState)({dealerId:"",startDate:"",endDate:""}),[s,t]=(0,a9.useState)(1),[u]=(0,a9.useState)(10);(0,a9.useEffect)(()=>{(async()=>{try{let[a,c]=await Promise.all([bc.getTransactions(),bc.getDealers()]);b(b=>({...b,transactions:a,dealers:c,isLoading:!1})),n(c)}catch(a){console.error("MongoDB Sync Failed:",a),b(a=>({...a,isLoading:!1}))}})()},[]),(0,a9.useEffect)(()=>{(async()=>{try{let a=await bc.getDealers();n(a)}catch(a){console.error("Failed to load dealers:",a)}})()},[]),(0,a9.useMemo)(()=>a.transactions.reduce((a,b)=>(a.totalWeight+=b.weightKg,a.totalRevenue+=b.totalAmount,a.totalChickens+=b.chickenCount,b.isPaid?a.paidAmount+=b.totalAmount:a.pendingAmount+=b.totalAmount,a.transactionCount++,a),{totalWeight:0,totalRevenue:0,totalChickens:0,pendingAmount:0,paidAmount:0,transactionCount:0}),[a.transactions]);let v=(0,a9.useMemo)(()=>a.transactions.filter(b=>{let c=b.dealerName.toLowerCase().includes(a.filters.search.toLowerCase()),d="all"===a.filters.status||"paid"===a.filters.status&&b.isPaid||"unpaid"===a.filters.status&&!b.isPaid,e=(!a.filters.startDate||b.date>=a.filters.startDate)&&(!a.filters.endDate||b.date<=a.filters.endDate),f=!a.filters.dealerId||b.dealerId===a.filters.dealerId;return c&&d&&e&&f}),[a.transactions,a.filters]);(0,a9.useEffect)(()=>{t(1)},[a.filters]);let w=(0,a9.useMemo)(()=>{let a=(s-1)*u;return v.slice(a,a+u)},[v,s,u]),x=Math.ceil(v.length/u),y=(0,a9.useMemo)(()=>a.transactions.filter(a=>{let b=(!q.startDate||a.date>=q.startDate)&&(!q.endDate||a.date<=q.endDate),c=!q.dealerId||a.dealerId===q.dealerId;return b&&c}),[a.transactions,q]),z=(0,a9.useMemo)(()=>y.reduce((a,b)=>(a.totalWeight+=b.weightKg,a.totalRevenue+=b.totalAmount,a.totalChickens+=b.chickenCount,b.isPaid?a.paidAmount+=b.totalAmount:a.pendingAmount+=b.totalAmount,a.transactionCount++,a),{totalWeight:0,totalRevenue:0,totalChickens:0,pendingAmount:0,paidAmount:0,transactionCount:0}),[y]),A=async a=>{l("adding");try{let c=await bc.saveTransaction(a);b(a=>({...a,transactions:[c,...a.transactions]})),d(!1)}catch(a){alert("Error saving to MongoDB. Verify your network and credentials.")}finally{l(null)}},B=async(a,c)=>{l(a);try{let d=await bc.updatePaymentStatus(a,!c);b(a=>({...a,transactions:d}))}catch(a){alert("Failed to update payment status in database.")}finally{l(null)}},C=async a=>{if(e){l(e.id);try{let c=await bc.updateTransaction(e.id,a);b(a=>({...a,transactions:c})),d(!1),f(null)}catch(a){alert("Error updating transaction in MongoDB. Verify your network and credentials.")}finally{l(null)}}},D=async a=>{try{let c=await bc.addDealer(a);n(a=>[...a,c]),b(a=>({...a,dealers:[...a.dealers,c]}))}catch(a){alert("Failed to add dealer.")}},E=async(a,c)=>{try{await bc.updateDealer(a,c),n(b=>b.map(b=>b.id===a?{...b,name:c}:b));let d=await bc.getTransactions();b(a=>({...a,transactions:d}))}catch(a){alert("Failed to update dealer.")}},F=async a=>{if(confirm("Permanently delete this record from MongoDB?")){l(a);try{let c=await bc.deleteTransaction(a);b(a=>({...a,transactions:c}))}catch(a){alert("Failed to delete record.")}finally{l(null)}}};return a.isLoading?(0,a8.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white space-y-6",children:[(0,a8.jsxs)("div",{className:"relative",children:[(0,a8.jsx)("div",{className:"w-20 h-20 border-4 border-slate-100 rounded-full"}),(0,a8.jsx)("div",{className:"w-20 h-20 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin absolute top-0"})]}),(0,a8.jsxs)("div",{className:"text-center",children:[(0,a8.jsx)("p",{className:"text-slate-900 font-black text-2xl tracking-tight",children:"Syncing with MongoDB"}),(0,a8.jsx)("p",{className:"text-slate-400 font-medium mt-1",children:"Establishing secure connection to your farm data..."})]})]}):(0,a8.jsxs)("div",{className:"min-h-screen bg-slate-50 selection:bg-emerald-100 selection:text-emerald-900",children:[(0,a8.jsx)("header",{className:"sticky top-0 z-40 bg-white/80 backdrop-blur-xl border-b border-slate-200/60",children:(0,a8.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between",children:[(0,a8.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a8.jsx)("div",{className:"bg-emerald-600 w-12 h-12 rounded-2xl flex items-center justify-center text-white text-2xl shadow-xl shadow-emerald-200 rotate-3",children:(0,a8.jsx)("i",{className:"fas fa-kiwi-bird -rotate-3"})}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("h1",{className:"text-2xl font-black text-slate-900 tracking-tight leading-none",children:"SA Farmshop"}),(0,a8.jsxs)("div",{className:"flex items-center mt-1 space-x-2",children:[(0,a8.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),(0,a8.jsx)("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Live Chicken Inventory & Sales Intelligence"})]})]})]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a8.jsxs)("button",{onClick:()=>p(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3.5 rounded-2xl font-black transition-all shadow-2xl shadow-blue-300 flex items-center space-x-3 active:scale-95",children:[(0,a8.jsx)("i",{className:"fas fa-users text-lg"}),(0,a8.jsx)("span",{children:"Dealers"})]}),(0,a8.jsxs)("button",{onClick:()=>d(!0),className:"bg-slate-900 hover:bg-black text-white px-8 py-3.5 rounded-2xl font-black transition-all shadow-2xl shadow-slate-300 flex items-center space-x-3 active:scale-95",children:[(0,a8.jsx)("i",{className:"fas fa-plus-circle text-lg"}),(0,a8.jsx)("span",{children:"Register Batch"})]})]})]})}),(0,a8.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[(0,a8.jsx)("div",{className:"mb-8 bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-200/60 p-6",children:(0,a8.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-6",children:[(0,a8.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a8.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-emerald-100 flex items-center justify-center text-emerald-600",children:(0,a8.jsx)("i",{className:"fas fa-filter text-lg"})}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("h3",{className:"text-lg font-black text-slate-900",children:"Dashboard Filters"}),(0,a8.jsx)("p",{className:"text-sm text-slate-500",children:"Filter statistics by dealer and date range"})]})]}),(0,a8.jsxs)("div",{className:"flex flex-wrap items-center gap-4 lg:ml-auto",children:[(0,a8.jsxs)("div",{className:"flex items-center bg-slate-50 border border-slate-200 rounded-2xl p-3",children:[(0,a8.jsx)("div",{className:"w-8 h-8 rounded-xl bg-slate-200 flex items-center justify-center text-slate-500 mr-3",children:(0,a8.jsx)("i",{className:"fas fa-user-tie text-sm"})}),(0,a8.jsxs)("select",{className:"bg-transparent text-sm font-semibold text-slate-800 outline-none cursor-pointer",value:q.dealerId,onChange:a=>r(b=>({...b,dealerId:a.target.value})),children:[(0,a8.jsx)("option",{value:"",children:"All Dealers"}),m.map(a=>(0,a8.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,a8.jsxs)("div",{className:"flex items-center bg-slate-50 border border-slate-200 rounded-2xl p-3",children:[(0,a8.jsx)("div",{className:"w-8 h-8 rounded-xl bg-slate-200 flex items-center justify-center text-slate-500 mr-3",children:(0,a8.jsx)("i",{className:"fas fa-calendar text-sm"})}),(0,a8.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a8.jsx)("input",{type:"date",className:"bg-transparent text-sm font-semibold outline-none text-slate-800 cursor-pointer",value:q.startDate,onChange:a=>r(b=>({...b,startDate:a.target.value}))}),(0,a8.jsx)("span",{className:"text-slate-400",children:"to"}),(0,a8.jsx)("input",{type:"date",className:"bg-transparent text-sm font-semibold outline-none text-slate-800 cursor-pointer",value:q.endDate,onChange:a=>r(b=>({...b,endDate:a.target.value}))})]})]})]})]})}),(0,a8.jsx)(cb,{stats:z}),(0,a8.jsxs)("div",{className:"mb-12 group relative",children:[(0,a8.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-[3rem] blur-2xl opacity-10 group-hover:opacity-20 transition-opacity"}),(0,a8.jsxs)("div",{className:"relative bg-slate-900 rounded-[3rem] p-10 text-white shadow-2xl border border-slate-800 overflow-hidden",children:[(0,a8.jsx)("div",{className:"absolute top-0 right-0 p-12 opacity-10",children:(0,a8.jsx)("i",{className:"fas fa-brain text-[12rem] -rotate-12"})}),(0,a8.jsx)("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-10",children:(0,a8.jsxs)("div",{className:"flex items-start space-x-8",children:[(0,a8.jsx)("div",{className:"bg-emerald-500/20 p-5 rounded-3xl border border-emerald-500/30",children:(0,a8.jsx)("i",{className:"fas fa-wand-magic-sparkles text-4xl text-emerald-400"})}),(0,a8.jsxs)("div",{className:"flex-1",children:[(0,a8.jsx)("h3",{className:"text-2xl font-black mb-3",children:"SA Farmshop"}),(0,a8.jsx)("p",{className:"text-slate-400 text-lg font-medium leading-relaxed max-w-2xl",children:g||"Your farm records are securely hosted on MongoDB. Analyze them now to detect payment risks and track dealer growth."})]})]})})]})]}),(0,a8.jsxs)("div",{className:"bg-white rounded-[3rem] shadow-2xl shadow-slate-200/50 border border-slate-200/60 overflow-hidden",children:[(0,a8.jsxs)("div",{className:"p-8 border-b border-slate-100 flex flex-col lg:flex-row lg:items-center gap-8 bg-slate-50/40",children:[(0,a8.jsxs)("div",{className:"flex-1 relative group",children:[(0,a8.jsx)("i",{className:"fas fa-search absolute left-6 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-emerald-500 transition-colors text-lg"}),(0,a8.jsx)("input",{type:"text",placeholder:"Search dealer database by name...",className:"w-full pl-16 pr-8 py-5 rounded-[1.5rem] border-2 border-slate-100 outline-none focus:border-emerald-500 focus:ring-4 focus:ring-emerald-50 transition-all text-sm font-black placeholder:text-slate-300 bg-white shadow-sm",value:a.filters.search,onChange:a=>b(b=>({...b,filters:{...b.filters,search:a.target.value}}))})]}),(0,a8.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[(0,a8.jsxs)("div",{className:"flex items-center bg-white border-2 border-slate-100 rounded-[1.5rem] p-2 pr-6 shadow-sm",children:[(0,a8.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-slate-50 flex items-center justify-center text-slate-400 mr-4",children:(0,a8.jsx)("i",{className:"fas fa-sliders text-lg"})}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("div",{className:"text-[9px] font-black text-slate-300 uppercase tracking-widest",children:"Filter Status"}),(0,a8.jsxs)("select",{className:"outline-none bg-transparent text-sm font-black text-slate-800 cursor-pointer pr-4",value:a.filters.status,onChange:a=>b(b=>({...b,filters:{...b.filters,status:a.target.value}})),children:[(0,a8.jsx)("option",{value:"all",children:"Full Ledger"}),(0,a8.jsx)("option",{value:"paid",children:"Verified Paid"}),(0,a8.jsx)("option",{value:"unpaid",children:"Due Payments"})]})]})]}),(0,a8.jsxs)("div",{className:"flex items-center bg-white border-2 border-slate-100 rounded-[1.5rem] p-2 pr-6 shadow-sm",children:[(0,a8.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-slate-50 flex items-center justify-center text-slate-400 mr-4",children:(0,a8.jsx)("i",{className:"fas fa-user-tie text-lg"})}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("div",{className:"text-[9px] font-black text-slate-300 uppercase tracking-widest",children:"Filter Dealer"}),(0,a8.jsxs)("select",{className:"outline-none bg-transparent text-sm font-black text-slate-800 cursor-pointer pr-4",value:a.filters.dealerId,onChange:a=>b(b=>({...b,filters:{...b.filters,dealerId:a.target.value}})),children:[(0,a8.jsx)("option",{value:"",children:"All Dealers"}),m.map(a=>(0,a8.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-4 bg-white border-2 border-slate-100 p-2 rounded-[1.5rem] shadow-sm",children:[(0,a8.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-slate-50 flex items-center justify-center text-slate-400",children:(0,a8.jsx)("i",{className:"fas fa-calendar-check text-lg"})}),(0,a8.jsxs)("div",{className:"flex items-center space-x-3 px-2",children:[(0,a8.jsx)("input",{type:"date",className:"bg-transparent text-xs font-black outline-none text-slate-800 cursor-pointer",value:a.filters.startDate,onChange:a=>b(b=>({...b,filters:{...b.filters,startDate:a.target.value}}))}),(0,a8.jsx)("div",{className:"w-4 h-[2px] bg-slate-200"}),(0,a8.jsx)("input",{type:"date",className:"bg-transparent text-xs font-black outline-none text-slate-800 cursor-pointer",value:a.filters.endDate,onChange:a=>b(b=>({...b,filters:{...b.filters,endDate:a.target.value}}))})]})]})]})]}),(0,a8.jsx)("div",{className:"overflow-x-auto",children:(0,a8.jsxs)("table",{className:"w-full",children:[(0,a8.jsx)("thead",{children:(0,a8.jsxs)("tr",{className:"bg-slate-50/50 text-slate-400 text-[10px] font-black uppercase tracking-[0.25em] border-b border-slate-100",children:[(0,a8.jsx)("th",{className:"px-10 py-7 text-left",children:"Timeline"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-left",children:"Dealer / Unit Price"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-center",children:"Batch Count"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-right",children:"Net Weight"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-right",children:"Total Payable"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-center",children:"Verification"}),(0,a8.jsx)("th",{className:"px-10 py-7 text-center",children:"Manage"})]})}),(0,a8.jsx)("tbody",{className:"divide-y divide-slate-100",children:w.length>0?w.map(a=>(0,a8.jsxs)("tr",{className:`group transition-all ${k===a.id?"opacity-40 grayscale pointer-events-none":"hover:bg-emerald-50/30"}`,children:[(0,a8.jsxs)("td",{className:"px-10 py-8",children:[(0,a8.jsx)("div",{className:"text-sm font-black text-slate-900",children:new Date(a.date).toLocaleDateString("en-US",{month:"long",day:"numeric"})}),(0,a8.jsxs)("div",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1",children:["Batch ID: ",a.id.slice(-6).toUpperCase()]})]}),(0,a8.jsx)("td",{className:"px-10 py-8",children:(0,a8.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,a8.jsx)("div",{className:"w-14 h-14 rounded-[1.25rem] bg-slate-100 flex items-center justify-center text-xl font-black text-slate-400 group-hover:bg-emerald-600 group-hover:text-white transition-all shadow-sm",children:a.dealerName.charAt(0)}),(0,a8.jsxs)("div",{children:[(0,a8.jsx)("div",{className:"font-black text-slate-900 text-xl tracking-tight group-hover:text-emerald-700 transition-colors",children:a.dealerName}),(0,a8.jsxs)("div",{className:"text-xs text-emerald-600/60 font-black mt-0.5 tracking-tight uppercase",children:["LKR ",a.pricePerKg.toLocaleString()," / kg"]}),a.note&&(0,a8.jsxs)("div",{className:"text-xs text-slate-500 font-medium mt-1 italic max-w-48 truncate",title:a.note,children:["ð ",a.note]})]})]})}),(0,a8.jsx)("td",{className:"px-10 py-8 text-center",children:(0,a8.jsxs)("div",{className:"inline-flex flex-col items-center justify-center min-w-[3rem] h-12 rounded-2xl bg-slate-50 text-slate-800 font-black",children:[(0,a8.jsx)("span",{className:"text-base leading-none",children:a.chickenCount}),(0,a8.jsx)("span",{className:"text-[8px] uppercase tracking-tighter opacity-40 mt-1",children:"units"})]})}),(0,a8.jsxs)("td",{className:"px-10 py-8 text-right",children:[(0,a8.jsx)("div",{className:"text-xl font-black text-slate-900",children:a.weightKg.toFixed(2)}),(0,a8.jsx)("div",{className:"text-[10px] text-emerald-600 font-black uppercase tracking-widest mt-1",children:"Kilograms"})]}),(0,a8.jsxs)("td",{className:"px-10 py-8 text-right",children:[(0,a8.jsxs)("div",{className:"text-2xl font-black text-slate-900 tracking-tighter",children:["LKR ",a.totalAmount.toLocaleString()]}),(0,a8.jsx)("div",{className:"text-[10px] text-slate-400 font-bold uppercase mt-1 tracking-tight italic",children:"Secure Sync"})]}),(0,a8.jsx)("td",{className:"px-10 py-8",children:(0,a8.jsx)("div",{className:"flex justify-center",children:(0,a8.jsxs)("button",{onClick:()=>B(a.id,a.isPaid),className:`group relative flex items-center space-x-3 px-6 py-3 rounded-[1.25rem] text-[11px] font-black transition-all border-2 shadow-sm active:scale-95 ${a.isPaid?"bg-emerald-600 text-white border-emerald-500 shadow-emerald-100":"bg-white text-rose-500 border-rose-100 hover:border-rose-300 hover:bg-rose-50"}`,children:[a.isPaid?(0,a8.jsxs)(a8.Fragment,{children:[(0,a8.jsx)("i",{className:"fas fa-circle-check text-sm animate-bounce-slow"}),(0,a8.jsx)("span",{children:"VERIFIED PAID"})]}):(0,a8.jsxs)(a8.Fragment,{children:[(0,a8.jsx)("i",{className:"fas fa-clock-rotate-left text-sm"}),(0,a8.jsx)("span",{children:"MARK AS PAID"})]}),!a.isPaid&&(0,a8.jsxs)("span",{className:"absolute -top-1 -right-1 flex h-4 w-4",children:[(0,a8.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-rose-400 opacity-75"}),(0,a8.jsx)("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-rose-500"})]})]})})}),(0,a8.jsx)("td",{className:"px-10 py-8",children:(0,a8.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a8.jsx)("button",{onClick:()=>{f(a),d(!0)},className:"w-14 h-14 flex items-center justify-center text-slate-300 hover:text-blue-600 hover:bg-blue-50 rounded-[1.25rem] transition-all active:scale-90",children:(0,a8.jsx)("i",{className:"fas fa-edit text-xl"})}),(0,a8.jsx)("button",{onClick:()=>F(a.id),className:"w-14 h-14 flex items-center justify-center text-slate-300 hover:text-rose-600 hover:bg-rose-50 rounded-[1.25rem] transition-all active:scale-90",children:(0,a8.jsx)("i",{className:"fas fa-trash-can text-xl"})})]})})]},a.id)):(0,a8.jsx)("tr",{children:(0,a8.jsx)("td",{colSpan:7,className:"px-10 py-40 text-center",children:(0,a8.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,a8.jsx)("div",{className:"w-28 h-28 bg-slate-50 rounded-[2.5rem] flex items-center justify-center mx-auto mb-8 shadow-inner",children:(0,a8.jsx)("i",{className:"fas fa-cloud-upload text-4xl text-slate-200"})}),(0,a8.jsx)("h4",{className:"text-2xl font-black text-slate-900 mb-3 tracking-tight",children:"MongoDB Ledger Empty"}),(0,a8.jsx)("p",{className:"text-slate-400 font-medium text-lg px-8",children:"No records found matching your filters. Register a new chicken delivery batch to begin cloud tracking."})]})})})})]})}),x>1&&(0,a8.jsx)("div",{className:"px-8 py-6 border-t border-slate-100 bg-slate-50/30",children:(0,a8.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a8.jsxs)("div",{className:"text-sm text-slate-600 font-medium",children:["Showing ",(s-1)*u+1," to ",Math.min(s*u,v.length)," of ",v.length," transactions"]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a8.jsxs)("button",{onClick:()=>t(a=>Math.max(a-1,1)),disabled:1===s,className:"px-4 py-2 text-sm font-semibold text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,a8.jsx)("i",{className:"fas fa-chevron-left mr-2"}),"Previous"]}),(0,a8.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,x)},(a,b)=>{let c=Math.max(1,Math.min(x-4,s-2))+b;return c>x?null:(0,a8.jsx)("button",{onClick:()=>t(c),className:`px-3 py-2 text-sm font-semibold rounded-lg transition-all ${s===c?"bg-emerald-600 text-white shadow-sm":"text-slate-600 bg-white border border-slate-200 hover:bg-slate-50"}`,children:c},c)})}),(0,a8.jsxs)("button",{onClick:()=>t(a=>Math.min(a+1,x)),disabled:s===x,className:"px-4 py-2 text-sm font-semibold text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:["Next",(0,a8.jsx)("i",{className:"fas fa-chevron-right ml-2"})]})]})]})})]})]}),c&&(0,a8.jsx)(cc,{onSave:e?C:A,onCancel:()=>{d(!1),f(null)},transaction:e,dealers:m,onAddDealer:D}),o&&(0,a8.jsx)(cd,{dealers:m,onAddDealer:D,onUpdateDealer:E,onClose:()=>p(!1)}),(0,a8.jsx)("footer",{className:"py-24 border-t border-slate-200/60 mt-20 bg-white",children:(0,a8.jsxs)("div",{className:"max-w-7xl mx-auto px-4 flex flex-col items-center",children:[(0,a8.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6 mb-12",children:[(0,a8.jsxs)("div",{className:"flex items-center space-x-3 bg-slate-50 px-6 py-3 rounded-2xl border border-slate-100",children:[(0,a8.jsx)("div",{className:"w-3 h-3 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]"}),(0,a8.jsx)("span",{className:"text-[11px] font-black text-slate-600 uppercase tracking-[0.2em]",children:"Primary Cluster: Healthy"})]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-3 bg-slate-50 px-6 py-3 rounded-2xl border border-slate-100",children:[(0,a8.jsx)("i",{className:"fas fa-shield-halved text-emerald-600 text-sm"}),(0,a8.jsx)("span",{className:"text-[11px] font-black text-slate-600 uppercase tracking-[0.2em]",children:"SSL Encryption: Active"})]})]}),(0,a8.jsxs)("div",{className:"flex items-center space-x-3 text-slate-900 mb-4 opacity-80",children:[(0,a8.jsx)("i",{className:"fas fa-kiwi-bird text-2xl text-emerald-600"}),(0,a8.jsx)("span",{className:"font-black tracking-tighter text-2xl",children:"SA Farmshop"})]}),(0,a8.jsx)("p",{className:"text-slate-400 text-[10px] font-black uppercase tracking-[0.4em] mb-10 text-center",children:"Live Chicken Inventory & Sales Intelligence"}),(0,a8.jsx)("div",{className:"h-[1px] w-full max-w-lg bg-gradient-to-r from-transparent via-slate-200 to-transparent mb-10"}),(0,a8.jsxs)("div",{className:"text-slate-300 text-[10px] font-bold text-center leading-loose",children:["Â© ",new Date().getFullYear()," SA Farmshop. Proprietary Software License.",(0,a8.jsx)("br",{}),"Connected to MongoDB Atlas: lakshanrathnayake.es@gmail.com"]})]})})]})}],60350)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__476fa233._.js.map